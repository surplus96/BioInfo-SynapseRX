<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fpocket: rpdb.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<img src="fpocket_logo_small.png" width="545" height="150">
<!-- Generated by Doxygen 1.5.6 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>rpdb.c File Reference</h1><code>#include &quot;<a class="el" href="rpdb_8h-source.html">../headers/rpdb.h</a>&quot;</code><br>

<p>
<a href="rpdb_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a> (char *pdb_line, char *type, int *atm_id, char *name, char *alt_loc, char *res_name, char *chain, int *res_id, char *insert, float *x, float *y, float *z, float *occ, float *bfactor, char *symbol, int *charge, int *guess_flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#b8eb6aa861c587d79cd28ad62ab5dd1f">element_in_kept_res</a> (char *res_name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#f9da9975a89a9736c1eda916abf10019">guess_element</a> (char *aname, char *element, char *res_name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#4436816d5e60b50c422000b95fb5f9de">is_N</a> (char *aname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#5e46f8bc26701fae5802311ef89918fb">is_O</a> (char *aname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a> (char *pdb_line, char *res_name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#8710b47d0170823a5d757d3f2ebf43c0">rpdb_extract_atom_values</a> (char *pdb_line, float *x, float *y, float *z, float *occ, float *bfactor)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#a1aa3ec53cf98fa511b7a2b320839350">rpdb_extract_cryst1</a> (char *pdb_line, float *alpha, float *beta, float *gamma, float *a, float *b, float *c)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#29ed3bff6fdc59fd8bf806a35c3127d7">rpdb_open</a> (char *fpath, const char *ligan, const int keep_lig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#1ec399102f369c72b06a9944616715b0">rpdb_read</a> (<a class="el" href="structs__pdb.html">s_pdb</a> *pdb, const char *ligan, const int keep_lig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#fda283d39ae56654675e9e858f5ffdea">free_pdb_atoms</a> (<a class="el" href="structs__pdb.html">s_pdb</a> *pdb)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpdb_8c.html#538712c3db672b5bd078348a0b541047">ST_nb_keep_hetatm</a> = 116</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="b8eb6aa861c587d79cd28ad62ab5dd1f"></a><!-- doxytag: member="rpdb.c::element_in_kept_res" ref="b8eb6aa861c587d79cd28ad62ab5dd1f" args="(char *res_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int element_in_kept_res           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>res_name</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00189">189</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="rpdb_8c-source.html#l00029">ST_keep_hetatm</a>, and <a class="el" href="rpdb_8c-source.html#l00045">ST_nb_keep_hetatm</a>.</p>

<p>Referenced by <a class="el" href="descriptors_8c-source.html#l00373">set_atom_based_descriptors()</a>, and <a class="el" href="pocket_8c-source.html#l00542">set_pocket_contacted_lig_name()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00189"></a>00189                                        {
<a name="l00190"></a>00190     <span class="keywordtype">int</span> i;
<a name="l00191"></a>00191     <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="rpdb_8c.html#538712c3db672b5bd078348a0b541047">ST_nb_keep_hetatm</a>;i++){
<a name="l00192"></a>00192         <span class="keywordflow">if</span>(!strncmp(res_name, <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i],3)) <span class="keywordflow">return</span> 1;
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194     <span class="keywordflow">return</span> 0;
<a name="l00195"></a>00195 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fda283d39ae56654675e9e858f5ffdea"></a><!-- doxytag: member="rpdb.c::free_pdb_atoms" ref="fda283d39ae56654675e9e858f5ffdea" args="(s_pdb *pdb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_pdb_atoms           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td>
          <td class="paramname"> <em>pdb</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: free_pdb_atoms<p>
## SPECIFICATION: Free memory for <a class="el" href="structs__pdb.html">s_pdb</a> structure<p>
## PARAMETRES: @ <a class="el" href="structs__pdb.html">s_pdb</a> *pdb: pdb struct to free<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00794">794</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="rpdb_8h-source.html#l00070">s_pdb::fpdb</a>, <a class="el" href="rpdb_8h-source.html#l00076">s_pdb::latm_lig</a>, <a class="el" href="rpdb_8h-source.html#l00072">s_pdb::latoms</a>, <a class="el" href="rpdb_8h-source.html#l00074">s_pdb::latoms_p</a>, <a class="el" href="rpdb_8h-source.html#l00075">s_pdb::lhetatm</a>, and <a class="el" href="memhandler_8c-source.html#l00255">my_free()</a>.</p>

<p>Referenced by <a class="el" href="dpocket_8c-source.html#l00184">desc_pocket()</a>, <a class="el" href="mdpocket_8c-source.html#l00217">mdpocket_characterize()</a>, <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>, and <a class="el" href="tpocket_8c-source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00795"></a>00795 {
<a name="l00796"></a>00796         <span class="keywordflow">if</span>(pdb) {
<a name="l00797"></a>00797                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>) {
<a name="l00798"></a>00798                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>) ;
<a name="l00799"></a>00799                         pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a> = NULL ;
<a name="l00800"></a>00800                 }
<a name="l00801"></a>00801 
<a name="l00802"></a>00802                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a>) {
<a name="l00803"></a>00803                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a>) ;
<a name="l00804"></a>00804                         pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a> = NULL ;
<a name="l00805"></a>00805                 }
<a name="l00806"></a>00806                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a>) {
<a name="l00807"></a>00807                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a>) ;
<a name="l00808"></a>00808                         pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> = NULL ;
<a name="l00809"></a>00809                 }
<a name="l00810"></a>00810                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) {
<a name="l00811"></a>00811                         fclose(pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) ;
<a name="l00812"></a>00812                         pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a> = NULL ;
<a name="l00813"></a>00813                 }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a>) {
<a name="l00816"></a>00816                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a>) ;
<a name="l00817"></a>00817                         pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a> = NULL ;
<a name="l00818"></a>00818                 }
<a name="l00819"></a>00819 
<a name="l00820"></a>00820                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb) ;
<a name="l00821"></a>00821         }
<a name="l00822"></a>00822 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f9da9975a89a9736c1eda916abf10019"></a><!-- doxytag: member="rpdb.c::guess_element" ref="f9da9975a89a9736c1eda916abf10019" args="(char *aname, char *element, char *res_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void guess_element           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>aname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>element</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>res_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: guess_element<p>
## SPECIFICATION: Guess the element of the atom based on atom name. The pattern matched here have been taken from the MOE PDB reader.<p>
' CL#' =&gt; Chlorine (use El field if it matches ' @?' &amp;&amp; HETATAM) CH2T from CT !!! =&gt; what not<p>
const AtomPatterns = [ N:'[A-G,I-L,N-Z]N#*', O:['[A-B,D-G,I-L,N-Z]O*','OP[A-C]#','CO[A-Z,0-9]*','OE##'], P:'[A-G,I-K,M-N,P-Z]P*', C:['[A-G,I-Z]C#*','C[B-G,I-K,M,P-T,V-Z]#*','CH#', 'BC '], H:['H[0-9,A-E,H-Z]*','#[0-9,A-Z]H*','?H[A-Z,0-9]*', 'HG##'], CL:'CL#', // check this S:'[P,N]S#*', SE:'NSE1' ];<p>
## PARAMETRES: @ char *atom_name : The atom name @ char *res_name : OUTPUT the element guessed<p>
## RETURN: void (element is the output) 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00228">228</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="pertable_8c-source.html#l00355">element_in_nucl_acid()</a>, <a class="el" href="pertable_8c-source.html#l00333">element_in_std_res()</a>, <a class="el" href="pertable_8c-source.html#l00282">is_valid_element()</a>, <a class="el" href="pertable_8c-source.html#l00437">is_valid_nucl_acid_element()</a>, <a class="el" href="pertable_8c-source.html#l00384">is_valid_prot_element()</a>, and <a class="el" href="utils_8c-source.html#l00528">str_trim()</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c-source.html#l00101">rpdb_extract_pdb_atom()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00229"></a>00229 {
<a name="l00230"></a>00230         <span class="comment">/* Use a temporary variable for atomname, mainly to remove spaces */</span>
<a name="l00231"></a>00231         <span class="keywordtype">char</span> tmp[strlen(aname)+1] ;
<a name="l00232"></a>00232         strcpy(tmp, aname) ;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234         <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(tmp) ;
<a name="l00235"></a>00235         <span class="keywordtype">char</span> *ptmp = tmp ;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237         <span class="comment">/* Move to the second caracter if we find a number */</span>
<a name="l00238"></a>00238         <span class="keywordflow">if</span>(isdigit(tmp[0])) ptmp = ptmp+1 ;
<a name="l00239"></a>00239 
<a name="l00240"></a>00240         <span class="keywordflow">if</span>(<a class="code" href="pertable_8c.html#9ec74074992414a252deb3bdb6f53af5">element_in_std_res</a>(res_name)){
<a name="l00241"></a>00241             <span class="comment">/* Check if its a valid element for standard residues in proteins */</span>
<a name="l00242"></a>00242 
<a name="l00243"></a>00243             <span class="keywordtype">int</span> index = <a class="code" href="pertable_8c.html#d8987379124bf6467d28a571c09327ee">is_valid_prot_element</a>(ptmp, 1) ;
<a name="l00244"></a>00244             <span class="keywordflow">if</span>(index != -1) {
<a name="l00245"></a>00245                 element[0] = ptmp[0];
<a name="l00246"></a>00246                 element[1] = <span class="charliteral">'\0'</span>;
<a name="l00247"></a>00247                 <span class="comment">//element[2] = '\0';</span>
<a name="l00248"></a>00248                 return ;
<a name="l00249"></a>00249             }
<a name="l00250"></a>00250         }
<a name="l00251"></a>00251         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="pertable_8c.html#9016391ffac695897fc618911af1077d">element_in_nucl_acid</a>(res_name)) {
<a name="l00252"></a>00252             <span class="keywordtype">int</span> index = <a class="code" href="pertable_8c.html#d1ab7881d279190272f4ba8af124dd22">is_valid_nucl_acid_element</a>(ptmp, 1) ;
<a name="l00253"></a>00253             <span class="keywordflow">if</span>(index != -1) {
<a name="l00254"></a>00254                 element[0] = ptmp[0];
<a name="l00255"></a>00255                 element[1] = <span class="charliteral">'\0'</span>;
<a name="l00256"></a>00256                 <span class="comment">//element[2] = '\0';</span>
<a name="l00257"></a>00257                 return ;
<a name="l00258"></a>00258             }
<a name="l00259"></a>00259         }
<a name="l00260"></a>00260         <span class="keywordflow">else</span> {
<a name="l00261"></a>00261             <span class="keywordtype">int</span> index = <a class="code" href="pertable_8c.html#6b05e53b42f5fe5907683fddc430cd39">is_valid_element</a>(ptmp, 1) ;
<a name="l00262"></a>00262             <span class="keywordflow">if</span>(index != -1) {
<a name="l00263"></a>00263                     strcpy(element,ptmp);
<a name="l00264"></a>00264                 return ;
<a name="l00265"></a>00265             }
<a name="l00266"></a>00266         }
<a name="l00267"></a>00267         <span class="comment">/* Here we have a special case... So take the first and second */</span>
<a name="l00268"></a>00268         element[0] = ptmp[0];
<a name="l00269"></a>00269         element[1] = ptmp[1];
<a name="l00270"></a>00270         element[2] = <span class="charliteral">'\0'</span>;
<a name="l00271"></a>00271 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4436816d5e60b50c422000b95fb5f9de"></a><!-- doxytag: member="rpdb.c::is_N" ref="4436816d5e60b50c422000b95fb5f9de" args="(char *aname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_N           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>aname</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00273">273</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="utils_8c-source.html#l00359">str_is_number()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00274"></a>00274 {       <span class="comment">/* N:'[A-G,I-L,N-Z]N#*' */</span>
<a name="l00275"></a>00275 
<a name="l00276"></a>00276         <span class="keywordflow">if</span>(aname[0] == <span class="charliteral">'N'</span> &amp;&amp; isdigit(aname[1])) <span class="keywordflow">return</span> 1 ;
<a name="l00277"></a>00277         <span class="keywordflow">if</span>( aname[0] != <span class="charliteral">'H'</span> &amp;&amp; aname[0] != <span class="charliteral">'M'</span> &amp;&amp; aname[1] == <span class="charliteral">'N'</span>
<a name="l00278"></a>00278                         &amp;&amp; <a class="code" href="utils_8c.html#bb731c23a19ad89ea0a69951672a1952">str_is_number</a>(aname, 0)) <span class="keywordflow">return</span> 1 ;
<a name="l00279"></a>00279 
<a name="l00280"></a>00280         <span class="keywordflow">return</span> 0 ;
<a name="l00281"></a>00281 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5e46f8bc26701fae5802311ef89918fb"></a><!-- doxytag: member="rpdb.c::is_O" ref="5e46f8bc26701fae5802311ef89918fb" args="(char *aname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_O           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>aname</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00283">283</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00284"></a>00284 {
<a name="l00285"></a>00285 <span class="comment">/*</span>
<a name="l00286"></a>00286 <span class="comment">          O:['[A-B,D-G,I-L,N-Z]O*','OP[A-C]#','CO[A-Z,0-9]*','OE##']</span>
<a name="l00287"></a>00287 <span class="comment">*/</span>
<a name="l00288"></a>00288         <span class="keywordflow">if</span>(aname[0] == <span class="charliteral">'O'</span>) {
<a name="l00289"></a>00289                 <span class="comment">/* TESTING     'OP[A-C]#' */</span>
<a name="l00290"></a>00290                 <span class="keywordflow">if</span>( aname[1] == <span class="charliteral">'P'</span> &amp;&amp; (aname[2] == <span class="charliteral">'A'</span> || aname[2] == <span class="charliteral">'B'</span> || aname[2] == <span class="charliteral">'C'</span>)
<a name="l00291"></a>00291                         &amp;&amp; isdigit(aname[3])) {
<a name="l00292"></a>00292                         <span class="keywordflow">return</span> 1 ;
<a name="l00293"></a>00293                 }
<a name="l00294"></a>00294 
<a name="l00295"></a>00295                 <span class="comment">/* TESTING     'OE##' */</span>
<a name="l00296"></a>00296                 <span class="keywordflow">if</span>(aname[1] == <span class="charliteral">'E'</span> &amp;&amp; isdigit(aname[2]) &amp;&amp; isdigit(aname[3])) <span class="keywordflow">return</span> 1 ;
<a name="l00297"></a>00297         }
<a name="l00298"></a>00298         <span class="keywordflow">else</span> {
<a name="l00299"></a>00299                 <span class="comment">/* TESTING     '[A-B,D-G,I-L,N-Z]O*' */</span>
<a name="l00300"></a>00300                 <span class="keywordflow">if</span>( aname[0] != <span class="charliteral">'C'</span> &amp;&amp; aname[0] != <span class="charliteral">'H'</span> &amp;&amp; aname[0] != <span class="charliteral">'M'</span> &amp;&amp; aname[1] == <span class="charliteral">'O'</span>)
<a name="l00301"></a>00301                         <span class="keywordflow">return</span> 1 ;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303                 <span class="comment">/* TESTING     'CO[A-Z,0-9]*' */</span>
<a name="l00304"></a>00304                 <span class="keywordflow">if</span>(aname[0] == <span class="charliteral">'C'</span> &amp;&amp; aname[1] == <span class="charliteral">'O'</span> &amp;&amp; aname[2] != <span class="charliteral">' '</span> &amp;&amp; aname[3] != <span class="charliteral">' '</span>)
<a name="l00305"></a>00305                         <span class="keywordflow">return</span> 1 ;
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308         <span class="keywordflow">return</span> 0 ;
<a name="l00309"></a>00309 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c4a87e3d2d6acef7bcadce143d4fa541"></a><!-- doxytag: member="rpdb.c::rpdb_extract_atm_resname" ref="c4a87e3d2d6acef7bcadce143d4fa541" args="(char *pdb_line, char *res_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_atm_resname           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>res_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_atm_resname<p>
## SPECIFICATION: Extract the residu name for an ATOM or HETATM pdb record. To remember:<p>
COLUMNS DATA TYPE FIELD DEFINITION<p>
18 - 20 Residue name resName Residue name.<p>
The memory to store the name has to be provided by the user.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ char *res_name : Pointer to residue name<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00332">332</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="utils_8c-source.html#l00528">str_trim()</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c-source.html#l00101">rpdb_extract_pdb_atom()</a>, <a class="el" href="rpdb_8c-source.html#l00478">rpdb_open()</a>, and <a class="el" href="rpdb_8c-source.html#l00599">rpdb_read()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00333"></a>00333 {
<a name="l00334"></a>00334 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00335"></a>00335 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00336"></a>00336 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00339"></a>00339 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00340"></a>00340 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="comment">/* Residue name */</span>
<a name="l00343"></a>00343         strncpy(res_name, pdb_line + 17, 4);
<a name="l00344"></a>00344         res_name[4] = <span class="charliteral">'\0'</span>;
<a name="l00345"></a>00345         <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(res_name);
<a name="l00346"></a>00346 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8710b47d0170823a5d757d3f2ebf43c0"></a><!-- doxytag: member="rpdb.c::rpdb_extract_atom_values" ref="8710b47d0170823a5d757d3f2ebf43c0" args="(char *pdb_line, float *x, float *y, float *z, float *occ, float *bfactor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_atom_values           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>bfactor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_atom_values<p>
## SPECIFICATION: Extract coordinates, occupancy and bfactor values from a pdb ATOM or HETATM line, and store them in given pointers.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ float *x, *y, *z : Pointer to coordinates @ float *occ : Pointer to occupency @ float *bfactor : Pointer to b-factor<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00365">365</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c-source.html#l00101">rpdb_extract_pdb_atom()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00367"></a>00367 {
<a name="l00368"></a>00368 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00369"></a>00369 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00370"></a>00370 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00373"></a>00373 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00374"></a>00374 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00375"></a>00375 
<a name="l00376"></a>00376         <span class="keywordtype">char</span> *ptr,
<a name="l00377"></a>00377                  ctmp ;
<a name="l00378"></a>00378 
<a name="l00379"></a>00379         ptr = pdb_line + 30 ;
<a name="l00380"></a>00380         ctmp = pdb_line[38] ; pdb_line[38] = <span class="charliteral">'\0'</span> ;
<a name="l00381"></a>00381         *x = (float) atof(ptr) ; pdb_line[38] = ctmp ;
<a name="l00382"></a>00382 
<a name="l00383"></a>00383         ptr = pdb_line + 38 ;
<a name="l00384"></a>00384         ctmp = pdb_line[46] ; pdb_line[46] = <span class="charliteral">'\0'</span> ;
<a name="l00385"></a>00385         *y = (float) atof(ptr) ; pdb_line[46] = ctmp ;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         ptr = pdb_line + 46 ;
<a name="l00388"></a>00388         ctmp = pdb_line[54] ; pdb_line[54] = <span class="charliteral">'\0'</span> ;
<a name="l00389"></a>00389         *z = (float) atof(ptr) ; pdb_line[54] = ctmp ;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391         ptr = pdb_line + 54 ;
<a name="l00392"></a>00392         ctmp = pdb_line[60] ; pdb_line[60] = <span class="charliteral">'\0'</span> ;
<a name="l00393"></a>00393         *occ = (float) atof(ptr) ; pdb_line[60] = ctmp ;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         ptr = pdb_line + 60 ;
<a name="l00396"></a>00396         ctmp = pdb_line[66] ; pdb_line[66] = <span class="charliteral">'\0'</span> ;
<a name="l00397"></a>00397         *bfactor = (float) atof(ptr) ; pdb_line[66] = ctmp ;
<a name="l00398"></a>00398 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a1aa3ec53cf98fa511b7a2b320839350"></a><!-- doxytag: member="rpdb.c::rpdb_extract_cryst1" ref="a1aa3ec53cf98fa511b7a2b320839350" args="(char *pdb_line, float *alpha, float *beta, float *gamma, float *a, float *b, float *c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_cryst1           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>c</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_cryst1<p>
## SPECIFICATION: Extract information on a box size from a pdb CRYSTL line, and store them in given pointers.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ float *alpha, *beta, *gamma : Pointer to angles @ float *A, B, C : Pointer sides length<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00416">416</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c-source.html#l00599">rpdb_read()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00418"></a>00418 {
<a name="l00419"></a>00419 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00420"></a>00420 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00421"></a>00421 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00424"></a>00424 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00425"></a>00425 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00426"></a>00426 
<a name="l00427"></a>00427         <span class="keywordtype">char</span> ch, *s;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429         s = pdb_line+6 ;
<a name="l00430"></a>00430         ch = pdb_line[15] ; pdb_line[15] = <span class="charliteral">'\0'</span> ;
<a name="l00431"></a>00431         *a = (float) atof(s) ;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433         s = pdb_line+15 ;
<a name="l00434"></a>00434         *s = ch ; ch = pdb_line[24]; pdb_line[24] = <span class="charliteral">'\0'</span> ;
<a name="l00435"></a>00435         *b = (float) atof(s) ;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437         s = pdb_line+24 ;
<a name="l00438"></a>00438         *s = ch; ch = pdb_line[33]; pdb_line[33] = <span class="charliteral">'\0'</span> ;
<a name="l00439"></a>00439         *c = (float) atof(s) ;
<a name="l00440"></a>00440 
<a name="l00441"></a>00441         s = pdb_line+33;
<a name="l00442"></a>00442         *s = ch; ch = pdb_line[40]; pdb_line[40] = <span class="charliteral">'\0'</span> ;
<a name="l00443"></a>00443         *alpha = (float) atof(s) ;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445         s = pdb_line+40;
<a name="l00446"></a>00446         *s = ch; ch = pdb_line[47]; pdb_line[47] = <span class="charliteral">'\0'</span> ;
<a name="l00447"></a>00447         *beta = (float) atof(s) ;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449         s = pdb_line+47;
<a name="l00450"></a>00450         *s = ch; ch = pdb_line[54]; pdb_line[54] = <span class="charliteral">'\0'</span> ;
<a name="l00451"></a>00451         *gamma = (float) atof(s) ;
<a name="l00452"></a>00452 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5e4cbe79a2e0cbd44f343846934ec2bd"></a><!-- doxytag: member="rpdb.c::rpdb_extract_pdb_atom" ref="5e4cbe79a2e0cbd44f343846934ec2bd" args="(char *pdb_line, char *type, int *atm_id, char *name, char *alt_loc, char *res_name, char *chain, int *res_id, char *insert, float *x, float *y, float *z, float *occ, float *bfactor, char *symbol, int *charge, int *guess_flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_extract_pdb_atom           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pdb_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>atm_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>alt_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>res_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>res_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>insert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>symbol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>guess_flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_extract_pdb_atom<p>
## SPECIFICATION: Extract all information given in a pdb ATOM or HETATM line, and store them in given pointers. User must therefore provide enough memory in parameter. PDB last known standart:<p>
COLUMNS DATA TYPE FIELD DEFINITION<p>
1 - 6 Record name "ATOM    " 7 - 11 Integer serial Atom serial number. 13 - 16 Atom name Atom name. 17 Character altLoc Alternate location indicator. 18 - 20 Residue name resName Residue name. 22 Character chainID Chain identifier. 23 - 26 Integer resSeq Residue sequence number. 27 AChar iCode Code for insertion of residues. 31 - 38 Real(8.3) x Orthogonal coordinates for X in Angstroms 39 - 46 Real(8.3) y Orthogonal coordinates for Y in Angstroms 47 - 54 Real(8.3) z Orthogonal coordinates for Z in Angstroms 55 - 60 Real(6.2) occupancy Occupancy. 61 - 66 Real(6.2) tempFactor Temperature factor. 77 - 78 LString(2) element Element symbol, right-justified. 79 - 80 LString(2) charge Charge on the atom.<p>
## PARAMETRES: @ char *pdb_line : The PDB line containings info @ int *atm_id : Pointer to atom ID @ char *name : Pointer to atom name @ char *res_name : Pointer to residue name @ char *chain : Pointer to chain name @ char *seg_name : Pointer to segment @ int *res_id : Pointer to residue ID @ char *insert : Pointer to insertion code @ char *alt_loc : Pointer to alternate location @ char *elem_symbol : Pointer to element symbol @ float *x, *y, *z : Pointer to coordinates @ float *occ : Pointer to occupency @ float *bfactor : Pointer to b-factor @ char *symbol : Pointer to symbol @ float *bfactor : Pointer to charge @ int guess_flag : Flag if elements were guessed<p>
## RETURN: void 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00101">101</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="rpdb_8c-source.html#l00228">guess_element()</a>, <a class="el" href="rpdb_8c-source.html#l00332">rpdb_extract_atm_resname()</a>, <a class="el" href="rpdb_8c-source.html#l00365">rpdb_extract_atom_values()</a>, and <a class="el" href="utils_8c-source.html#l00528">str_trim()</a>.</p>

<p>Referenced by <a class="el" href="check_8c-source.html#l00414">load_pdb_line()</a>, and <a class="el" href="rpdb_8c-source.html#l00599">rpdb_read()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00106"></a>00106 {
<a name="l00107"></a>00107 <span class="comment">/* Position:          1         2         3         4         5         6 */</span>
<a name="l00108"></a>00108 <span class="comment">/* Position: 123456789012345678901234567890123456789012345678901234567890 */</span>
<a name="l00109"></a>00109 <span class="comment">/* Record:   ATOM    145  N   VAL A  25      32.433  16.336  57.540  1.00 */</span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="comment">/* Position: 6         7         8 */</span>
<a name="l00112"></a>00112 <span class="comment">/* Position: 012345678901234567890 */</span>
<a name="l00113"></a>00113 <span class="comment">/* Record:   0 11.92           N   */</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <span class="keywordtype">int</span> rlen = strlen(pdb_line) ;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <span class="keywordtype">char</span> *prt,
<a name="l00118"></a>00118                  ctmp ;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120         <span class="comment">/* Record type */</span>
<a name="l00121"></a>00121         strncpy(type, pdb_line, 6) ;
<a name="l00122"></a>00122 
<a name="l00123"></a>00123         <span class="comment">/* Atom ID */</span>
<a name="l00124"></a>00124         prt = pdb_line + 6 ;
<a name="l00125"></a>00125         ctmp = pdb_line[11] ; pdb_line[11] = <span class="charliteral">'\0'</span> ;
<a name="l00126"></a>00126         *atm_id = atoi(prt) ; pdb_line[11] = ctmp ;
<a name="l00127"></a>00127 
<a name="l00128"></a>00128         <span class="comment">/* Atom name */</span>
<a name="l00129"></a>00129         strncpy(name, pdb_line + 12, 4);
<a name="l00130"></a>00130         name[4] = <span class="charliteral">'\0'</span>;
<a name="l00131"></a>00131         <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(name) ;
<a name="l00132"></a>00132 
<a name="l00133"></a>00133         <span class="comment">/* Alternate location identifier */</span>
<a name="l00134"></a>00134         *alt_loc = pdb_line[16] ;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136         <span class="comment">/* Residue name */</span>
<a name="l00137"></a>00137         <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(pdb_line, res_name) ;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139         <span class="comment">/* Chain name */</span>
<a name="l00140"></a>00140         chain[0] = pdb_line[21];
<a name="l00141"></a>00141         chain[1] = <span class="charliteral">'\0'</span>;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143         <span class="comment">/* Residue id number */</span>
<a name="l00144"></a>00144         prt = pdb_line + 22 ;
<a name="l00145"></a>00145         ctmp = pdb_line[26] ; pdb_line[26] = <span class="charliteral">'\0'</span> ;
<a name="l00146"></a>00146         *res_id = atoi(prt) ; pdb_line[26] = ctmp ;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148         <span class="comment">/* Insertion code */</span>
<a name="l00149"></a>00149         *insert = pdb_line[26];
<a name="l00150"></a>00150 
<a name="l00151"></a>00151         <span class="comment">/* x, y, and z coordinates, occupancy and b-factor */</span>
<a name="l00152"></a>00152         <a class="code" href="rpdb_8c.html#8710b47d0170823a5d757d3f2ebf43c0">rpdb_extract_atom_values</a>(pdb_line, x, y, z, occ, bfactor);
<a name="l00153"></a>00153 
<a name="l00154"></a>00154         <span class="comment">/* Atomic element symbol (if does not exists, guess it based on</span>
<a name="l00155"></a>00155 <span class="comment">         * atom name */</span>
<a name="l00156"></a>00156         <span class="keywordflow">if</span> (rlen &gt;= 77) {
<a name="l00157"></a>00157                 strncpy(symbol, pdb_line + 76, 2);
<a name="l00158"></a>00158                 symbol[2] = <span class="charliteral">'\0'</span>;
<a name="l00159"></a>00159                 <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(symbol); <span class="comment">/* remove spaces */</span>
<a name="l00160"></a>00160                 <span class="keywordflow">if</span>(strlen(symbol) &lt; 1) {
<a name="l00161"></a>00161                         <a class="code" href="rpdb_8c.html#f9da9975a89a9736c1eda916abf10019">guess_element</a>(name, symbol,res_name) ;
<a name="l00162"></a>00162                         *guess_flag+=1;
<a name="l00163"></a>00163                 }
<a name="l00164"></a>00164         }
<a name="l00165"></a>00165         <span class="keywordflow">else</span> {
<a name="l00166"></a>00166                 <a class="code" href="rpdb_8c.html#f9da9975a89a9736c1eda916abf10019">guess_element</a>(name, symbol,res_name) ;
<a name="l00167"></a>00167                 *guess_flag+=1;
<a name="l00168"></a>00168         }
<a name="l00169"></a>00169         <a class="code" href="utils_8c.html#ed930c5e93a75d90a96195282790d467">str_trim</a>(symbol); <span class="comment">/* remove spaces */</span>
<a name="l00170"></a>00170 
<a name="l00171"></a>00171         <span class="comment">/* Charge */</span>
<a name="l00172"></a>00172         <span class="keywordflow">if</span>(rlen &gt;= 79) {
<a name="l00173"></a>00173             <span class="keywordtype">char</span> buf[4] = <span class="stringliteral">"   "</span> ;
<a name="l00174"></a>00174                 <span class="keywordflow">if</span>((pdb_line[78] == <span class="charliteral">' '</span> &amp;&amp; pdb_line[79] == <span class="charliteral">' '</span>) || pdb_line[78] == <span class="charliteral">'\n'</span>){
<a name="l00175"></a>00175                         *charge = 0 ;
<a name="l00176"></a>00176                 }
<a name="l00177"></a>00177                 <span class="keywordflow">else</span> {
<a name="l00178"></a>00178                         buf[0] = pdb_line[78] ;
<a name="l00179"></a>00179                         buf[1] = pdb_line[79] ;
<a name="l00180"></a>00180                         buf[2] = <span class="charliteral">'\0'</span> ;
<a name="l00181"></a>00181                         *charge = (int) atoi(buf) ;
<a name="l00182"></a>00182                 }
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184         <span class="keywordflow">else</span> *charge = 0 ;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="29ed3bff6fdc59fd8bf806a35c3127d7"></a><!-- doxytag: member="rpdb.c::rpdb_open" ref="29ed3bff6fdc59fd8bf806a35c3127d7" args="(char *fpath, const char *ligan, const int keep_lig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structs__pdb.html">s_pdb</a>* rpdb_open           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ligan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>keep_lig</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_open<p>
## SPECIFICATION: Open a PDB file, alloc memory for all information on this pdb, and store several information like the number of atoms, the header, the remark... This first reading of PDB rewinds the FILE* pointer. No coordinates are actually read.<p>
Hydrogens are conserved. All HETATM are removed, except the given ligand if we have to keep it, and important HETATM listed in the static structure at the top of this file.<p>
## PARAMETRES: @ const char *fpath : The pdb path. @ const char *ligan : Ligand resname. @ const char *keep_lig : Keep the given ligand or not?<p>
## RETURN: <a class="el" href="structs__pdb.html">s_pdb</a>: data containing PDB info. 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00478">478</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="utils_8c-source.html#l00714">fopen_pdb_check_case()</a>, <a class="el" href="rpdb_8h-source.html#l00070">s_pdb::fpdb</a>, <a class="el" href="rpdb_8h-source.html#l00076">s_pdb::latm_lig</a>, <a class="el" href="rpdb_8h-source.html#l00072">s_pdb::latoms</a>, <a class="el" href="rpdb_8h-source.html#l00074">s_pdb::latoms_p</a>, <a class="el" href="rpdb_8h-source.html#l00075">s_pdb::lhetatm</a>, <a class="el" href="rpdb_8h-source.html#l00047">M_PDB_BUF_LEN</a>, <a class="el" href="rpdb_8h-source.html#l00046">M_PDB_LINE_LEN</a>, <a class="el" href="memhandler_8c-source.html#l00153">my_calloc()</a>, <a class="el" href="memhandler_8c-source.html#l00255">my_free()</a>, <a class="el" href="memhandler_8c-source.html#l00121">my_malloc()</a>, <a class="el" href="rpdb_8h-source.html#l00078">s_pdb::natm_lig</a>, <a class="el" href="rpdb_8h-source.html#l00078">s_pdb::natoms</a>, <a class="el" href="rpdb_8h-source.html#l00078">s_pdb::nhetatm</a>, <a class="el" href="rpdb_8c-source.html#l00332">rpdb_extract_atm_resname()</a>, <a class="el" href="rpdb_8c-source.html#l00029">ST_keep_hetatm</a>, and <a class="el" href="rpdb_8c-source.html#l00045">ST_nb_keep_hetatm</a>.</p>

<p>Referenced by <a class="el" href="check_8c-source.html#l00105">check_fpocket()</a>, <a class="el" href="dpocket_8c-source.html#l00184">desc_pocket()</a>, <a class="el" href="mdpocket_8c-source.html#l00217">mdpocket_characterize()</a>, <a class="el" href="mdpocket_8c-source.html#l00426">open_pdb_file()</a>, <a class="el" href="fpmain_8c-source.html#l00130">process_pdb()</a>, and <a class="el" href="tpocket_8c-source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00479"></a>00479 {
<a name="l00480"></a>00480         <a class="code" href="structs__pdb.html">s_pdb</a> *pdb = NULL ;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482         <span class="keywordtype">char</span> buf[<a class="code" href="rpdb_8h.html#ce73bc2986adaa1837bc97e2757f1bb5">M_PDB_BUF_LEN</a>],
<a name="l00483"></a>00483                  resb[5] ;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         <span class="keywordtype">int</span> nhetatm = 0,
<a name="l00486"></a>00486                 natoms = 0,
<a name="l00487"></a>00487                 natm_lig = 0 ;
<a name="l00488"></a>00488         <span class="keywordtype">int</span> i ;
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         pdb = (<a class="code" href="structs__pdb.html">s_pdb</a> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structs__pdb.html">s_pdb</a>)) ; ;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492         <span class="comment">/* Open the PDB file in read-only mode */</span>
<a name="l00493"></a>00493         pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a> = <a class="code" href="utils_8c.html#8ec5b0b9f097dc4fc2807ca47d242ac9">fopen_pdb_check_case</a>(fpath, <span class="stringliteral">"r"</span>);
<a name="l00494"></a>00494         <span class="keywordflow">if</span> (!pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) {
<a name="l00495"></a>00495                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb) ;
<a name="l00496"></a>00496                 fprintf(stderr, <span class="stringliteral">"! File %s does not exist\n"</span>, fpath) ;
<a name="l00497"></a>00497                 <span class="keywordflow">return</span> NULL ;
<a name="l00498"></a>00498         }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500         <span class="keywordflow">while</span>(fgets(buf, <a class="code" href="rpdb_8h.html#81915efba694ad7576ecf5768b66a318">M_PDB_LINE_LEN</a> + 2, pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>)) {
<a name="l00501"></a>00501                 <span class="keywordflow">if</span> (!strncmp(buf, <span class="stringliteral">"ATOM "</span>,  5)) {
<a name="l00502"></a>00502                 <span class="comment">/* Check if this is the first occurence of this atom*/</span>
<a name="l00503"></a>00503                         <span class="keywordflow">if</span>(buf[16]==<span class="charliteral">' '</span> || buf[16]==<span class="charliteral">'A'</span>){
<a name="l00504"></a>00504                         <span class="comment">/* Atom entry: check if there is a ligand in there (just in case)... */</span>
<a name="l00505"></a>00505                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(buf, resb) ;
<a name="l00506"></a>00506                                 <span class="keywordflow">if</span>( ligan &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1]
<a name="l00507"></a>00507                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00508"></a>00508 
<a name="l00509"></a>00509                                         <span class="keywordflow">if</span>(keep_lig) {
<a name="l00510"></a>00510                                                 natm_lig ++ ;
<a name="l00511"></a>00511                                                 natoms++ ;
<a name="l00512"></a>00512                                         }
<a name="l00513"></a>00513                                 }
<a name="l00514"></a>00514                                 <span class="keywordflow">else</span> {
<a name="l00515"></a>00515                                         natoms++ ;
<a name="l00516"></a>00516                                 }
<a name="l00517"></a>00517                         }
<a name="l00518"></a>00518                 }
<a name="l00519"></a>00519                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strncmp(buf, <span class="stringliteral">"HETATM"</span>, 6)) {
<a name="l00520"></a>00520                         <span class="comment">/*Check again for the first occurence*/</span>
<a name="l00521"></a>00521                         <span class="keywordflow">if</span>(buf[16]==<span class="charliteral">' '</span> || buf[16]==<span class="charliteral">'A'</span>){
<a name="l00522"></a>00522                                 <span class="comment">/* Hetatom entry: check if there is a ligand in there too... */</span>
<a name="l00523"></a>00523                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(buf, resb) ;
<a name="l00524"></a>00524                                 <span class="keywordflow">if</span>( keep_lig &amp;&amp; ligan &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1]
<a name="l00525"></a>00525                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00526"></a>00526                                         natm_lig ++ ; natoms++ ;
<a name="l00527"></a>00527                                 }
<a name="l00528"></a>00528                                 <span class="keywordflow">else</span> {
<a name="l00529"></a>00529                                 <span class="comment">/* Keep specific HETATM given in the static list ST_keep_hetatm */</span>
<a name="l00530"></a>00530                                     <span class="keywordflow">if</span> (keep_lig &amp;&amp; ! ligan &amp;&amp; strncmp(resb,<span class="stringliteral">"HOH"</span>,3) &amp;&amp; strncmp(resb,<span class="stringliteral">"WAT"</span>,3)){
<a name="l00531"></a>00531                                         natoms++ ; nhetatm++ ;
<a name="l00532"></a>00532                                     }
<a name="l00533"></a>00533                                     <span class="keywordflow">else</span> {
<a name="l00534"></a>00534                                         <span class="keywordflow">for</span>(i = 0 ; i &lt; <a class="code" href="rpdb_8c.html#538712c3db672b5bd078348a0b541047">ST_nb_keep_hetatm</a> ; i++) {
<a name="l00535"></a>00535                                                         <span class="keywordflow">if</span>(<a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][0] == resb[0] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][1]
<a name="l00536"></a>00536                                                                 == resb[1] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][2] == resb[2]) {
<a name="l00537"></a>00537                                                                         nhetatm++ ; natoms++ ;
<a name="l00538"></a>00538                                                                         break ;
<a name="l00539"></a>00539                                                         }
<a name="l00540"></a>00540                                         }
<a name="l00541"></a>00541                                     }
<a name="l00542"></a>00542                                 }
<a name="l00543"></a>00543                         }
<a name="l00544"></a>00544                 }
<a name="l00545"></a>00545 <span class="comment">/*</span>
<a name="l00546"></a>00546 <span class="comment">                else if (!strncmp(buf, "HEADER", 6))</span>
<a name="l00547"></a>00547 <span class="comment">                        strncpy(pdb-&gt;header, buf, M_PDB_BUF_LEN) ;</span>
<a name="l00548"></a>00548 <span class="comment">*/</span>
<a name="l00549"></a>00549 
<a name="l00550"></a>00550                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(buf, <span class="stringliteral">"END"</span>, 3)) break ;
<a name="l00551"></a>00551         }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553         <span class="keywordflow">if</span> (natoms == 0) {
<a name="l00554"></a>00554                 fprintf(stderr, <span class="stringliteral">"! File '%s' contains no atoms...\n"</span>, fpath) ;
<a name="l00555"></a>00555                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(pdb) ;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557                 <span class="keywordflow">return</span> NULL ;
<a name="l00558"></a>00558         }
<a name="l00559"></a>00559 
<a name="l00560"></a>00560         <span class="comment">/* Alloc needed memory */</span>
<a name="l00561"></a>00561         pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a> = (<a class="code" href="structs__atm.html">s_atm</a>*) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(natoms, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>)) ;
<a name="l00562"></a>00562         pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a> = (<a class="code" href="structs__atm.html">s_atm</a>**) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(natoms, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>*)) ;
<a name="l00563"></a>00563 
<a name="l00564"></a>00564         <span class="keywordflow">if</span>(nhetatm &gt; 0) pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a> = (<a class="code" href="structs__atm.html">s_atm</a>**) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(nhetatm, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>*)) ;
<a name="l00565"></a>00565         <span class="keywordflow">else</span> pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a> = NULL ;
<a name="l00566"></a>00566 
<a name="l00567"></a>00567         <span class="keywordflow">if</span>(natm_lig &gt; 0) pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> = (<a class="code" href="structs__atm.html">s_atm</a>**) <a class="code" href="memhandler_8c.html#e1a54755aeeb11b927875d686a5248c7">my_calloc</a>(natm_lig, <span class="keyword">sizeof</span>(<a class="code" href="structs__atm.html">s_atm</a>*)) ;
<a name="l00568"></a>00568         <span class="keywordflow">else</span> pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> = NULL ;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570         pdb-&gt;<a class="code" href="structs__pdb.html#85aaf7bdb931bb303af1ca736a998b98">natoms</a> = natoms ;
<a name="l00571"></a>00571         pdb-&gt;<a class="code" href="structs__pdb.html#2e9c327d5029e032b77a67664d6466a7">nhetatm</a> = nhetatm ;
<a name="l00572"></a>00572         pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> = natm_lig ;
<a name="l00573"></a>00573         rewind(pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>) ;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575         <span class="keywordflow">return</span> pdb ;
<a name="l00576"></a>00576 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1ec399102f369c72b06a9944616715b0"></a><!-- doxytag: member="rpdb.c::rpdb_read" ref="1ec399102f369c72b06a9944616715b0" args="(s_pdb *pdb, const char *ligan, const int keep_lig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rpdb_read           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td>
          <td class="paramname"> <em>pdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ligan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>keep_lig</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: rpdb_read<p>
## SPECIFICATION: Read and store information on atoms for a pdb file. Curently:<ul>
<li>Hydrogens present in the PDB are kept</li><li>HETATM are ignored except for specific cofactor, small molecule... listed in ST_keep_hetatm variable, and for a given ligand, defined by its resname.</li><li>Solvent molecules are ignored</li></ul>
<p>
## PARAMETRES: @ <a class="el" href="structs__pdb.html">s_pdb</a> *pdb : The structure to fill @ const char *ligand : The ligand resname @ const char *keep_lig : Keep the given ligand or not?<p>
## RETURN: 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00599">599</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>References <a class="el" href="rpdb_8h-source.html#l00082">s_pdb::A</a>, <a class="el" href="rpdb_8h-source.html#l00082">s_pdb::alpha</a>, <a class="el" href="rpdb_8h-source.html#l00082">s_pdb::B</a>, <a class="el" href="rpdb_8h-source.html#l00082">s_pdb::beta</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::bfactor</a>, <a class="el" href="rpdb_8h-source.html#l00082">s_pdb::C</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::chain</a>, <a class="el" href="atom_8h-source.html#l00063">s_atm::charge</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::electroneg</a>, <a class="el" href="rpdb_8h-source.html#l00070">s_pdb::fpdb</a>, <a class="el" href="rpdb_8h-source.html#l00082">s_pdb::gamma</a>, <a class="el" href="atom_8h-source.html#l00063">s_atm::id</a>, <a class="el" href="rpdb_8h-source.html#l00076">s_pdb::latm_lig</a>, <a class="el" href="rpdb_8h-source.html#l00072">s_pdb::latoms</a>, <a class="el" href="rpdb_8h-source.html#l00074">s_pdb::latoms_p</a>, <a class="el" href="rpdb_8h-source.html#l00075">s_pdb::lhetatm</a>, <a class="el" href="rpdb_8h-source.html#l00047">M_PDB_BUF_LEN</a>, <a class="el" href="rpdb_8h-source.html#l00046">M_PDB_LINE_LEN</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::mass</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::name</a>, <a class="el" href="rpdb_8h-source.html#l00078">s_pdb::natm_lig</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::occupancy</a>, <a class="el" href="atom_8h-source.html#l00076">s_atm::pdb_aloc</a>, <a class="el" href="atom_8h-source.html#l00076">s_atm::pdb_insert</a>, <a class="el" href="pertable_8c-source.html#l00247">pte_get_enegativity()</a>, <a class="el" href="pertable_8c-source.html#l00178">pte_get_mass()</a>, <a class="el" href="pertable_8c-source.html#l00213">pte_get_vdw_ray()</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::radius</a>, <a class="el" href="atom_8h-source.html#l00063">s_atm::res_id</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::res_name</a>, <a class="el" href="rpdb_8c-source.html#l00332">rpdb_extract_atm_resname()</a>, <a class="el" href="rpdb_8c-source.html#l00416">rpdb_extract_cryst1()</a>, <a class="el" href="rpdb_8c-source.html#l00101">rpdb_extract_pdb_atom()</a>, <a class="el" href="atom_8h-source.html#l00054">s_atm::sort_x</a>, <a class="el" href="rpdb_8c-source.html#l00029">ST_keep_hetatm</a>, <a class="el" href="rpdb_8c-source.html#l00045">ST_nb_keep_hetatm</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::symbol</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::type</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>

<p>Referenced by <a class="el" href="check_8c-source.html#l00105">check_fpocket()</a>, <a class="el" href="dpocket_8c-source.html#l00184">desc_pocket()</a>, <a class="el" href="mdpocket_8c-source.html#l00217">mdpocket_characterize()</a>, <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>, <a class="el" href="mdpocket_8c-source.html#l00460">mdprocess_pdb()</a>, <a class="el" href="fpmain_8c-source.html#l00130">process_pdb()</a>, and <a class="el" href="tpocket_8c-source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00600"></a>00600 {
<a name="l00601"></a>00601         <span class="keywordtype">int</span> i,
<a name="l00602"></a>00602                 iatoms,
<a name="l00603"></a>00603                 ihetatm,
<a name="l00604"></a>00604                 iatm_lig,
<a name="l00605"></a>00605                 ligfound ;
<a name="l00606"></a>00606 
<a name="l00607"></a>00607         <span class="keywordtype">char</span> pdb_line[<a class="code" href="rpdb_8h.html#ce73bc2986adaa1837bc97e2757f1bb5">M_PDB_BUF_LEN</a>],
<a name="l00608"></a>00608                  resb[5] ;                                      <span class="comment">/* Buffer for the current residue name */</span>
<a name="l00609"></a>00609 
<a name="l00610"></a>00610         <a class="code" href="structs__atm.html">s_atm</a> *atom = NULL ;
<a name="l00611"></a>00611         <a class="code" href="structs__atm.html">s_atm</a> *atoms = pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a> ;
<a name="l00612"></a>00612         <a class="code" href="structs__atm.html">s_atm</a> **atoms_p = pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a> ;
<a name="l00613"></a>00613         <a class="code" href="structs__atm.html">s_atm</a> **atm_lig = pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a> ;
<a name="l00614"></a>00614         <span class="keywordtype">int</span> guess_flag=0;
<a name="l00615"></a>00615         iatoms = 0 ;
<a name="l00616"></a>00616         ihetatm = 0 ;
<a name="l00617"></a>00617         iatm_lig = 0 ;
<a name="l00618"></a>00618         ligfound = 0 ;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620         <span class="comment">/* Loop over the pdb file */</span>
<a name="l00621"></a>00621         <span class="keywordflow">while</span>(fgets(pdb_line, <a class="code" href="rpdb_8h.html#81915efba694ad7576ecf5768b66a318">M_PDB_LINE_LEN</a> + 2, pdb-&gt;<a class="code" href="structs__pdb.html#ee6f65655c18f873a00ab5ab376c84c7">fpdb</a>)) {
<a name="l00622"></a>00622                 <span class="keywordflow">if</span> (strncmp(pdb_line, <span class="stringliteral">"ATOM "</span>,  5) == 0) {
<a name="l00623"></a>00623                         <span class="keywordflow">if</span>(pdb_line[16]==<span class="charliteral">' '</span> || pdb_line[16]==<span class="charliteral">'A'</span>){ <span class="comment">/*if within first occurence*/</span>
<a name="l00624"></a>00624                                 <span class="comment">/* Store ATOM entry */</span>
<a name="l00625"></a>00625                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(pdb_line, resb) ;
<a name="l00626"></a>00626                                 <span class="comment">/* Check if the desired ligand is in such entry */</span>
<a name="l00627"></a>00627                                 <span class="keywordflow">if</span>( ligan &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1]
<a name="l00628"></a>00628                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00629"></a>00629                                         <span class="keywordflow">if</span>(keep_lig) {
<a name="l00630"></a>00630                                                 atom = atoms + iatoms ;
<a name="l00631"></a>00631 
<a name="l00632"></a>00632                                                 <span class="comment">/* Read atom information */</span>
<a name="l00633"></a>00633                                                 <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>),
<a name="l00634"></a>00634                                                                 atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>,
<a name="l00635"></a>00635                                                                 atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>),
<a name="l00636"></a>00636                                                                 &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>),
<a name="l00637"></a>00637                                                                 &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>), atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>,
<a name="l00638"></a>00638                                                                 &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00639"></a>00639 
<a name="l00640"></a>00640                                                 <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00641"></a>00641                                                 atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00642"></a>00642                                                 atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00643"></a>00643                                                 atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00644"></a>00644                                                 atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646                                                 atoms_p[iatoms] = atom ;
<a name="l00647"></a>00647                                                 iatoms++ ;
<a name="l00648"></a>00648 
<a name="l00649"></a>00649                                                 atm_lig[iatm_lig] = atom ;
<a name="l00650"></a>00650                                                 iatm_lig ++ ;
<a name="l00651"></a>00651                                                 ligfound = 1 ;
<a name="l00652"></a>00652                                         }
<a name="l00653"></a>00653                                 }
<a name="l00654"></a>00654                                 <span class="keywordflow">else</span> {
<a name="l00655"></a>00655                                 <span class="comment">/* A simple atom not supposed to be stored as a ligand */</span>
<a name="l00656"></a>00656                                         atom = atoms + iatoms ;
<a name="l00657"></a>00657                                         <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>),
<a name="l00658"></a>00658                                                         atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>,
<a name="l00659"></a>00659                                                         atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>),
<a name="l00660"></a>00660                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>),
<a name="l00661"></a>00661                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>), atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663                                         <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00664"></a>00664                                         atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00665"></a>00665                                         atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00666"></a>00666                                         atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00667"></a>00667                                         atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669                                         atoms_p[iatoms] = atom ;
<a name="l00670"></a>00670                                         iatoms++ ;
<a name="l00671"></a>00671                                 }
<a name="l00672"></a>00672                         }
<a name="l00673"></a>00673                 }
<a name="l00674"></a>00674                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strncmp(pdb_line, <span class="stringliteral">"HETATM"</span>, 6) == 0) {
<a name="l00675"></a>00675                         <span class="keywordflow">if</span>(pdb_line[16]==<span class="charliteral">' '</span> || pdb_line[16]==<span class="charliteral">'A'</span>){<span class="comment">/*first occurence*/</span>
<a name="l00676"></a>00676                                 <span class="comment">/* Check HETATM entry */</span>
<a name="l00677"></a>00677                                 <a class="code" href="rpdb_8c.html#c4a87e3d2d6acef7bcadce143d4fa541">rpdb_extract_atm_resname</a>(pdb_line, resb) ;
<a name="l00678"></a>00678                                 <span class="comment">/* Check if the desired ligand is in HETATM entry */</span>
<a name="l00679"></a>00679                                 <span class="keywordflow">if</span>( ligan &amp;&amp; keep_lig &amp;&amp; ligan[0] == resb[0] &amp;&amp; ligan[1] == resb[1]
<a name="l00680"></a>00680                                         &amp;&amp; ligan[2] == resb[2]){
<a name="l00681"></a>00681 
<a name="l00682"></a>00682                                         atom = atoms + iatoms ;
<a name="l00683"></a>00683                                         <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>),
<a name="l00684"></a>00684                                                         atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>,
<a name="l00685"></a>00685                                                         atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>),
<a name="l00686"></a>00686                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>),
<a name="l00687"></a>00687                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>), atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00688"></a>00688 
<a name="l00689"></a>00689                                         <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00690"></a>00690                                         atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00691"></a>00691                                         atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00692"></a>00692                                         atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00693"></a>00693                                         atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00694"></a>00694 
<a name="l00695"></a>00695                                         atoms_p[iatoms] = atom ;
<a name="l00696"></a>00696                                         atm_lig[iatm_lig] = atom ;
<a name="l00697"></a>00697 
<a name="l00698"></a>00698                                         iatm_lig ++ ; iatoms++ ;
<a name="l00699"></a>00699                                         ligfound = 1 ;
<a name="l00700"></a>00700                                 }
<a name="l00701"></a>00701                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>) {
<a name="l00702"></a>00702                                     
<a name="l00703"></a>00703                                 <span class="comment">/* Keep specific HETATM given in the static list ST_keep_hetatm. */</span>
<a name="l00704"></a>00704                                     <span class="keywordflow">if</span> (keep_lig &amp;&amp; ! ligan &amp;&amp; strncmp(resb,<span class="stringliteral">"HOH"</span>,3) &amp;&amp; strncmp(resb,<span class="stringliteral">"WAT"</span>,3)){
<a name="l00705"></a>00705                                             atom = atoms + iatoms ;
<a name="l00706"></a>00706                                             <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>),
<a name="l00707"></a>00707                                                             atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>,
<a name="l00708"></a>00708                                                             atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>),
<a name="l00709"></a>00709                                                             &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>),
<a name="l00710"></a>00710                                                             &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>),
<a name="l00711"></a>00711                                                             atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00712"></a>00712 
<a name="l00713"></a>00713                                     <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00714"></a>00714                                             atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00715"></a>00715                                             atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00716"></a>00716                                             atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00717"></a>00717                                             atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719                                             atoms_p[iatoms] = atom ;
<a name="l00720"></a>00720                                             pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>[ihetatm] = atom ;
<a name="l00721"></a>00721                                             ihetatm ++ ; iatoms++ ;
<a name="l00722"></a>00722                                     }
<a name="l00723"></a>00723                                     <span class="keywordflow">else</span> {
<a name="l00724"></a>00724                                         <span class="keywordflow">for</span>(i = 0 ; i &lt; <a class="code" href="rpdb_8c.html#538712c3db672b5bd078348a0b541047">ST_nb_keep_hetatm</a> ; i++) {
<a name="l00725"></a>00725                                                 <span class="keywordflow">if</span>( <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][0] == resb[0] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][1]
<a name="l00726"></a>00726                                                         == resb[1] &amp;&amp; <a class="code" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[i][2] == resb[2]) {
<a name="l00727"></a>00727                                                         atom = atoms + iatoms ;
<a name="l00728"></a>00728                                                         <a class="code" href="rpdb_8c.html#5e4cbe79a2e0cbd44f343846934ec2bd">rpdb_extract_pdb_atom</a>(pdb_line, atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>),
<a name="l00729"></a>00729                                                                         atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#58eeb8a80942caa3bd2374f3175cb77d">pdb_aloc</a>), atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>,
<a name="l00730"></a>00730                                                                         atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#bfd1f905200f69dd9cd9750fd305cf46">pdb_insert</a>),
<a name="l00731"></a>00731                                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>),
<a name="l00732"></a>00732                                                                         &amp;(atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>), &amp;(atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>),
<a name="l00733"></a>00733                                                                         atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, &amp;(atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>), &amp;guess_flag);
<a name="l00734"></a>00734 
<a name="l00735"></a>00735                                                 <span class="comment">/* Store additional information not given in the pdb */</span>
<a name="l00736"></a>00736                                                         atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> = <a class="code" href="pertable_8c.html#3eeaf52663f6057aee4f869d5c78a8c8">pte_get_mass</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00737"></a>00737                                                         atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> = <a class="code" href="pertable_8c.html#e4452b6c03cdbc3ea402b7f4ef183eee">pte_get_vdw_ray</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00738"></a>00738                                                         atom-&gt;<a class="code" href="structs__atm.html#f41b525ee3032d47baf2db10387f022c">electroneg</a> = <a class="code" href="pertable_8c.html#5dda7fa72655b6d311e2a41ef049d5d6">pte_get_enegativity</a>(atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>) ;
<a name="l00739"></a>00739                                                         atom-&gt;<a class="code" href="structs__atm.html#05407d7638ff7f6fc210026306def9b5">sort_x</a> = -1 ;
<a name="l00740"></a>00740 
<a name="l00741"></a>00741                                                         atoms_p[iatoms] = atom ;
<a name="l00742"></a>00742                                                         pdb-&gt;<a class="code" href="structs__pdb.html#85c1747a66e7aabfe388f5c9debd17a2">lhetatm</a>[ihetatm] = atom ;
<a name="l00743"></a>00743                                                         ihetatm ++ ; iatoms++ ;
<a name="l00744"></a>00744                                                         break ;
<a name="l00745"></a>00745                                                 }
<a name="l00746"></a>00746                                         }
<a name="l00747"></a>00747                                     }
<a name="l00748"></a>00748                                 }
<a name="l00749"></a>00749                         }
<a name="l00750"></a>00750                 }
<a name="l00751"></a>00751                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(pdb_line, <span class="stringliteral">"CRYST1"</span>,  6) == 0)  {
<a name="l00752"></a>00752                         <a class="code" href="rpdb_8c.html#a1aa3ec53cf98fa511b7a2b320839350">rpdb_extract_cryst1</a>(pdb_line, &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#68ced10f4d2d6f8eff8e99750f816fb4">alpha</a>), &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#264782f353ab5791c4b2b213f78599a5">beta</a>), &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#b85054178fcffe54c253eaa81d422203">gamma</a>),
<a name="l00753"></a>00753                                                                          &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#c4ed1aee14eb31f82a90a7caadc69e4d">A</a>),  &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#539c9e10542bd3d0a3f4940ec0381f8f">B</a>), &amp;(pdb-&gt;<a class="code" href="structs__pdb.html#4ba25329db7e91cbebfbb22a6c185ec6">C</a>));
<a name="l00754"></a>00754                 }
<a name="l00755"></a>00755                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(pdb_line, <span class="stringliteral">"END"</span>, 3)) break ;
<a name="l00756"></a>00756         }
<a name="l00757"></a>00757 
<a name="l00758"></a>00758 
<a name="l00759"></a>00759         <span class="comment">/*if(guess_flag&gt;0) {</span>
<a name="l00760"></a>00760 <span class="comment">            fprintf(stderr, "&gt;! Warning: You did not provide a standard PDB file.\nElements were guessed by fpocket, because not provided in the PDB file. \nThere is no guarantee on the results!\n");</span>
<a name="l00761"></a>00761 <span class="comment">        }*/</span>
<a name="l00762"></a>00762 
<a name="l00763"></a>00763         <span class="keywordflow">if</span>(ligan &amp;&amp; keep_lig &amp;&amp; (ligfound == 0 || pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> &lt;= 0)) {
<a name="l00764"></a>00764                 fprintf(stderr, <span class="stringliteral">"&gt;! Warning: ligand '%s' not found in the pdb...\n"</span>, ligan) ;
<a name="l00765"></a>00765                 <span class="keywordflow">if</span>(pdb-&gt;<a class="code" href="structs__pdb.html#fe85c6dd76ee9c740d2869ee30621ea5">latm_lig</a>) fprintf(stderr, <span class="stringliteral">"! Ligand list is not NULL however...\n"</span>) ;
<a name="l00766"></a>00766                 <span class="keywordflow">if</span>(ligfound == 1) fprintf(stderr, <span class="stringliteral">"! And ligfound == 1!! :-/\n"</span>) ;
<a name="l00767"></a>00767         }
<a name="l00768"></a>00768         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ligfound == 1 &amp;&amp; iatm_lig &lt;= 0) {
<a name="l00769"></a>00769                 fprintf(stderr, <span class="stringliteral">"&gt;! Warning: ligand '%s' has been detected but no atoms \</span>
<a name="l00770"></a>00770 <span class="stringliteral">                                                has been stored!\n"</span>, ligan) ;
<a name="l00771"></a>00771         }
<a name="l00772"></a>00772         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((ligfound == 1 &amp;&amp; pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> &lt;= 0) || (pdb-&gt;<a class="code" href="structs__pdb.html#659b83804ffc576f1307beac00c1486b">natm_lig</a> &lt;=0
<a name="l00773"></a>00773                          &amp;&amp; iatm_lig &gt; 0)) {
<a name="l00774"></a>00774                 fprintf(stderr, <span class="stringliteral">"&gt;! Warning: ligand '%s' has been detected in rpdb_read \</span>
<a name="l00775"></a>00775 <span class="stringliteral">                                                but not in rpdb_open!\n"</span>, ligan) ;
<a name="l00776"></a>00776         }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="7845a49fcf29010920bc5f6280ece46a"></a><!-- doxytag: member="rpdb.c::ST_keep_hetatm" ref="7845a49fcf29010920bc5f6280ece46a" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="rpdb_8c.html#7845a49fcf29010920bc5f6280ece46a">ST_keep_hetatm</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {

        <span class="stringliteral">"HEA"</span>, <span class="stringliteral">"HBI"</span>, <span class="stringliteral">"BIO"</span>, <span class="stringliteral">"CFM"</span>, <span class="stringliteral">"CLP"</span>, <span class="stringliteral">"FES"</span>, <span class="stringliteral">"F3S"</span>, <span class="stringliteral">"FS3"</span>, <span class="stringliteral">"FS4"</span>, <span class="stringliteral">"BPH"</span>,
        <span class="stringliteral">"BPB"</span>, <span class="stringliteral">"BCL"</span>, <span class="stringliteral">"BCB"</span>, <span class="stringliteral">"COB"</span>, <span class="stringliteral">"ZN"</span>, <span class="stringliteral">"FEA"</span>, <span class="stringliteral">"FEO"</span>, <span class="stringliteral">"H4B"</span>, <span class="stringliteral">"BH4"</span>, <span class="stringliteral">"BHS"</span>,
        <span class="stringliteral">"HBL"</span>, <span class="stringliteral">"THB"</span>, <span class="stringliteral">"DDH"</span>, <span class="stringliteral">"DHE"</span>, <span class="stringliteral">"HAS"</span>, <span class="stringliteral">"HDD"</span>, <span class="stringliteral">"HDM"</span>, <span class="stringliteral">"HEB"</span>, <span class="stringliteral">"HEC"</span>, <span class="stringliteral">"HEO"</span>,
        <span class="stringliteral">"HES"</span>, <span class="stringliteral">"HEV"</span>, <span class="stringliteral">"MHM"</span>, <span class="stringliteral">"SRM"</span>, <span class="stringliteral">"VER"</span>, <span class="stringliteral">"1FH"</span>, <span class="stringliteral">"2FH"</span>, <span class="stringliteral">"HC0"</span>, <span class="stringliteral">"HC1"</span>, <span class="stringliteral">"HF3"</span>,
        <span class="stringliteral">"HF5"</span>, <span class="stringliteral">"NFS"</span>, <span class="stringliteral">"OMO"</span>, <span class="stringliteral">"PHF"</span>, <span class="stringliteral">"SF3"</span>, <span class="stringliteral">"SF4"</span>, <span class="stringliteral">"CFM"</span>, <span class="stringliteral">"CFN"</span>, <span class="stringliteral">"CLF"</span>, <span class="stringliteral">"CLP"</span>,
        <span class="stringliteral">"CN1"</span>, <span class="stringliteral">"CNB"</span>, <span class="stringliteral">"CNF"</span>, <span class="stringliteral">"CUB"</span>, <span class="stringliteral">"CUM"</span>, <span class="stringliteral">"CUN"</span>, <span class="stringliteral">"CUO"</span>, <span class="stringliteral">"F3S"</span>, <span class="stringliteral">"FES"</span>, <span class="stringliteral">"FS2"</span>,
        <span class="stringliteral">"FS3"</span>, <span class="stringliteral">"FS4"</span>, <span class="stringliteral">"FSO"</span>, <span class="stringliteral">"FSX"</span>, <span class="stringliteral">"PHO"</span>, <span class="stringliteral">"BH1"</span>, <span class="stringliteral">"CHL"</span>, <span class="stringliteral">"CL1"</span>, <span class="stringliteral">"CL2"</span>, <span class="stringliteral">"CLA"</span>,
        <span class="stringliteral">"CCH"</span>, <span class="stringliteral">"CFO"</span>, <span class="stringliteral">"FE2"</span>, <span class="stringliteral">"FCI"</span>, <span class="stringliteral">"FCO"</span>, <span class="stringliteral">"FDC"</span>, <span class="stringliteral">"FEA"</span>, <span class="stringliteral">"FEO"</span>, <span class="stringliteral">"FNE"</span>, <span class="stringliteral">"HIF"</span>,
        <span class="stringliteral">"OFO"</span>, <span class="stringliteral">"PFC"</span>, <span class="stringliteral">"HE5"</span>, <span class="stringliteral">"BAZ"</span>, <span class="stringliteral">"BOZ"</span>, <span class="stringliteral">"FE"</span>, <span class="stringliteral">"HEM"</span>, <span class="stringliteral">"HCO"</span>, <span class="stringliteral">"1CP"</span>, <span class="stringliteral">"CLN"</span>,
        <span class="stringliteral">"COH"</span>, <span class="stringliteral">"CP3"</span>, <span class="stringliteral">"DEU"</span>, <span class="stringliteral">"FDD"</span>, <span class="stringliteral">"FDE"</span>, <span class="stringliteral">"FEC"</span>, <span class="stringliteral">"FMI"</span>, <span class="stringliteral">"HE5"</span>, <span class="stringliteral">"HEG"</span>, <span class="stringliteral">"HIF"</span>,
        <span class="stringliteral">"HNI"</span>, <span class="stringliteral">"MMP"</span>, <span class="stringliteral">"MNH"</span>, <span class="stringliteral">"MNR"</span>, <span class="stringliteral">"MP1"</span>, <span class="stringliteral">"PC3"</span>, <span class="stringliteral">"PCU"</span>, <span class="stringliteral">"PNI"</span>, <span class="stringliteral">"POR"</span>, <span class="stringliteral">"PP9"</span>,
        <span class="stringliteral">"MSE"</span>, <span class="stringliteral">"HIE"</span>, <span class="stringliteral">"HID"</span>, <span class="stringliteral">"HIP"</span>,<span class="stringliteral">"ACE"</span>,<span class="stringliteral">"FAD"</span>
}
</pre></div>## ----- GENERAL INFORMATIONS ## ## FILE <a class="el" href="rpdb_8c.html">rpdb.c</a> ## AUTHORS P. Schmidtke and V. Le Guilloux ## LAST MODIFIED 01-04-08 ## ## ----- SPECIFICATIONS ## ----- MODIFICATIONS HISTORY ## ## 15-09-08 (p) Modifications on allocation (casting made C++ compiler compatible) ## 01-04-08 (v) Added template for comments and creation of history ## 01-01-08 (vp) Created (random date...) ## ## ----- TODO or SUGGESTIONS ## A list of HETATM to keep in each case! REF Peter? no ref... 
<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00029">29</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c-source.html#l00189">element_in_kept_res()</a>, <a class="el" href="rpdb_8c-source.html#l00478">rpdb_open()</a>, and <a class="el" href="rpdb_8c-source.html#l00599">rpdb_read()</a>.</p>

</div>
</div><p>
<a class="anchor" name="538712c3db672b5bd078348a0b541047"></a><!-- doxytag: member="rpdb.c::ST_nb_keep_hetatm" ref="538712c3db672b5bd078348a0b541047" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="rpdb_8c.html#538712c3db672b5bd078348a0b541047">ST_nb_keep_hetatm</a> = 116<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="rpdb_8c-source.html#l00045">45</a> of file <a class="el" href="rpdb_8c-source.html">rpdb.c</a>.</p>

<p>Referenced by <a class="el" href="rpdb_8c-source.html#l00189">element_in_kept_res()</a>, <a class="el" href="rpdb_8c-source.html#l00478">rpdb_open()</a>, and <a class="el" href="rpdb_8c-source.html#l00599">rpdb_read()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 7 16:44:23 2010 for fpocket by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
