<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fpocket: mdpbase.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<img src="fpocket_logo_small.png" width="545" height="150">
<!-- Generated by Doxygen 1.5.6 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>mdpbase.c File Reference</h1><code>#include &quot;<a class="el" href="mdpbase_8h-source.html">../headers/mdpbase.h</a>&quot;</code><br>

<p>
<a href="mdpbase_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#ec2d0f5a143a25df23d35ffc8382f008">store_vertice_positions</a> (<a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m, <a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#3662fa60097d0d0eeb5d5c692b3f252b">calculate_md_dens_grid</a> (<a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g, <a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets, <a class="el" href="structs__mdparams.html">s_mdparams</a> *par)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#b17b0eaff6d9e3509adec9d37e3ba766">update_md_grid</a> (<a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g, <a class="el" href="structs__mdgrid.html">s_mdgrid</a> *refg, <a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets, <a class="el" href="structs__mdparams.html">s_mdparams</a> *par)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#797f3a7e29293b29134777ed5d0fd30b">reset_grid</a> (<a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#d158097a42d8f3d71016a9fdd8cdf125">project_grid_on_atoms</a> (<a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g, <a class="el" href="structs__pdb.html">s_pdb</a> *pdb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#475c8060a73d5cd6cf9e32977e0feac1">normalize_grid</a> (<a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g, int n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structs__mdconcat.html">s_mdconcat</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#0a8aaf97120635fb837cbe8464814ea7">init_md_concat</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structs__min__max__pockets.html">s_min_max_pockets</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#fa97c7e89d66d007fe7d7dda7856b691">float_get_min_max_from_pockets</a> (<a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structs__mdgrid.html">s_mdgrid</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#3a661550596173bd65329c1ced46ef06">init_md_grid</a> (<a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#68058a8dac54dfcb290df9a1bd96200a">alloc_first_md_concat</a> (<a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m, size_t n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#1bab69995238614fbcaa0121c91936f7">realloc_md_concat</a> (<a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m, size_t n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdpbase_8c.html#026cc6969faf96af18e73415eca39340">free_mdconcat</a> (<a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="68058a8dac54dfcb290df9a1bd96200a"></a><!-- doxytag: member="mdpbase.c::alloc_first_md_concat" ref="68058a8dac54dfcb290df9a1bd96200a" args="(s_mdconcat *m, size_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alloc_first_md_concat           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdconcat.html">s_mdconcat</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: alloc_first_md_concat<p>
## SPECIFICATION: Allocate memory for the md concat structure (first snapshot)<p>
## PARAMETRES: @ <a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m: Pointer to the structure to free, @ size_t n: Number of vertices in the snapshot to add to m<p>
## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00490">490</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>Referenced by <a class="el" href="mdpbase_8c-source.html#l00070">store_vertice_positions()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00490"></a>00490                                                     {
<a name="l00491"></a>00491     <span class="keywordtype">size_t</span> z;
<a name="l00492"></a>00492     m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a> = (<span class="keywordtype">float</span> **) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<span class="keywordtype">float</span> *) * n);
<a name="l00493"></a>00493     <span class="keywordflow">for</span> (z = 0; z &lt; n; z++) {
<a name="l00494"></a>00494         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[z] = (<span class="keywordtype">float</span> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<span class="keywordtype">float</span>) *4);
<a name="l00495"></a>00495         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[z][0] = 0.0;
<a name="l00496"></a>00496         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[z][1] = 0.0;
<a name="l00497"></a>00497         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[z][2] = 0.0;
<a name="l00498"></a>00498         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[z][3] = 0.0;
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500     m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> = n;
<a name="l00501"></a>00501 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3662fa60097d0d0eeb5d5c692b3f252b"></a><!-- doxytag: member="mdpbase.c::calculate_md_dens_grid" ref="3662fa60097d0d0eeb5d5c692b3f252b" args="(s_mdgrid *g, c_lst_pockets *pockets, s_mdparams *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_md_dens_grid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdgrid.html">s_mdgrid</a> *&nbsp;</td>
          <td class="paramname"> <em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *&nbsp;</td>
          <td class="paramname"> <em>pockets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__mdparams.html">s_mdparams</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: calculate_md_dens_grid<p>
## SPECIFICATION: Do the actual grid calculation (count number of vertices near a grid point) NOT USED ANYMORE ## PARAMETRES: @ <a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g: Grid structure @ <a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets : Pocket chained list @ <a class="el" href="structs__mdparams.html">s_mdparams</a> *par : Parameters of mdpocket<p>
## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00104">104</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="descriptors_8h-source.html#l00099">s_desc::drug_score</a>, <a class="el" href="voronoi__lst_8h-source.html#l00064">c_lst_vertices::first</a>, <a class="el" href="pocket_8h-source.html#l00089">c_lst_pockets::first</a>, <a class="el" href="mdparams_8h-source.html#l00139">s_mdparams::flag_scoring</a>, <a class="el" href="mdpbase_8h-source.html#l00086">s_mdgrid::gridvalues</a>, <a class="el" href="mdpbase_8h-source.html#l00065">M_MDP_CUBE_SIDE</a>, <a class="el" href="pocket_8h-source.html#l00080">node_pocket::next</a>, <a class="el" href="voronoi__lst_8h-source.html#l00056">node_vertice::next</a>, <a class="el" href="mdpbase_8h-source.html#l00087">s_mdgrid::origin</a>, <a class="el" href="pocket_8h-source.html#l00061">s_pocket::pdesc</a>, <a class="el" href="pocket_8h-source.html#l00082">node_pocket::pocket</a>, <a class="el" href="mdpbase_8h-source.html#l00089">s_mdgrid::resolution</a>, <a class="el" href="pocket_8h-source.html#l00063">s_pocket::v_lst</a>, <a class="el" href="voronoi__lst_8h-source.html#l00058">node_vertice::vertice</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>

<p>Referenced by <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00104"></a>00104                                                                                   {
<a name="l00105"></a>00105     <span class="keywordtype">int</span> xidx = 0, yidx = 0, zidx = 0; <span class="comment">/*direct indices of the positions in the grid*/</span>
<a name="l00106"></a>00106     <span class="keywordtype">int</span> sxidx, syidx, szidx; <span class="comment">/*indices nearby xidx,yidx,zidx that are within M_MDP_CUBE_SIDE of this point*/</span>
<a name="l00107"></a>00107     <span class="keywordtype">int</span> sxi = 0, syi = 0, szi = 0;
<a name="l00108"></a>00108     <span class="keywordtype">float</span> vx, vy, vz;
<a name="l00109"></a>00109     <span class="keywordtype">float</span> incre = 1.0;
<a name="l00110"></a>00110     <a class="code" href="structnode__pocket.html">node_pocket</a> *cp = NULL;
<a name="l00111"></a>00111     <a class="code" href="structs__pocket.html">s_pocket</a> *pocket = NULL;
<a name="l00112"></a>00112     <a class="code" href="structnode__vertice.html">node_vertice</a> *cnv = NULL;
<a name="l00113"></a>00113     <a class="code" href="structs__vvertice.html">s_vvertice</a> *cv = NULL;
<a name="l00114"></a>00114     <span class="keywordtype">int</span> s = (int) (((<span class="keywordtype">float</span>) <a class="code" href="mdpbase_8h.html#6ac8f76875e6adfaafa8b21413658576">M_MDP_CUBE_SIDE</a> / 2.0) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>); <span class="comment">/*possible stepsize (resolution dependent) in the discrete grid*/</span>
<a name="l00115"></a>00115     <span class="comment">/*loop over all known vertices and CALCULATE the grid positions and increment grid values by 1*/</span>
<a name="l00116"></a>00116     <span class="comment">/*important : no distance calculations are done here, thus this routine is very fast*/</span>
<a name="l00117"></a>00117     cp = pockets-&gt;<a class="code" href="structc__lst__pockets.html#cf82eb35ce757228759a9af7675f5ad9">first</a>;
<a name="l00118"></a>00118     <span class="keywordflow">while</span> (cp) { <span class="comment">/*loop over pockets*/</span>
<a name="l00119"></a>00119         pocket = cp-&gt;<a class="code" href="structnode__pocket.html#8dbdbb50f893fa45bba2d8c03aff6553">pocket</a>;
<a name="l00120"></a>00120         cnv = pocket-&gt;<a class="code" href="structs__pocket.html#cf07f539404d23c1956373f8c93a4fcc">v_lst</a>-&gt;<a class="code" href="structc__lst__vertices.html#72562067d308bcfcf32605e112e30c1a">first</a>;
<a name="l00121"></a>00121         <span class="comment">/*if(par-&gt;flag_scoring) incre=pocket-&gt;score;*/</span>
<a name="l00122"></a>00122         <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structs__mdparams.html#dc8ce867fa68a31df1f58de97341ddc6">flag_scoring</a>) incre = pocket-&gt;<a class="code" href="structs__pocket.html#aba02d3ca1a41adf62ad69884c85fed5">pdesc</a>-&gt;<a class="code" href="structs__desc.html#27317d1ebeb59e4ea4ebdbca11069c3c">drug_score</a>; <span class="comment">/*if we score by drug score, use it as increment here instead of the 1 by default*/</span>
<a name="l00123"></a>00123         <span class="keywordflow">while</span> (cnv) { <span class="comment">/*loop over all vertices of a pocket*/</span>
<a name="l00124"></a>00124             cv = cnv-&gt;<a class="code" href="structnode__vertice.html#7e7063f6403dfd8f0a8f83462e27729b">vertice</a>;
<a name="l00125"></a>00125             vx = cv-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>; <span class="comment">/*tmp the vertice position*/</span>
<a name="l00126"></a>00126             vy = cv-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>;
<a name="l00127"></a>00127             vz = cv-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>;
<a name="l00128"></a>00128             xidx = (int) roundf((vx - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>); <span class="comment">/*calculate the nearest grid point internal coordinates*/</span>
<a name="l00129"></a>00129             yidx = (int) roundf((vy - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00130"></a>00130             zidx = (int) roundf((vz - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00131"></a>00131             <span class="comment">/*we use a cube of M_MDP_CUBE_SIDE**3 volume to check if there are grid points nearby,</span>
<a name="l00132"></a>00132 <span class="comment">             *thus a check in the neighbourhood is performed here...this looks a bit awful and should be changed later on*/</span>
<a name="l00133"></a>00133             <span class="keywordflow">for</span> (sxi = -s; sxi &lt;= s; sxi++) {
<a name="l00134"></a>00134                 <span class="keywordflow">for</span> (syi = -s; syi &lt;= s; syi++) {
<a name="l00135"></a>00135                     <span class="keywordflow">for</span> (szi = -s; szi &lt;= s; szi++) {
<a name="l00136"></a>00136                         <span class="comment">/*check if we are not on the point xidx,yidx, zidx....the square sum is just a little trick*/</span>
<a name="l00137"></a>00137                         <span class="keywordflow">if</span> ((sxi * sxi + syi * syi + szi * szi) != 0) {
<a name="l00138"></a>00138                             <span class="comment">/*next we have to check in a discrete manner if we can include a new grid point or not.*/</span>
<a name="l00139"></a>00139                             <span class="keywordflow">if</span> (sxi &lt; 0) sxidx = (int) ceil(((<span class="keywordtype">float</span>) sxi + vx - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00140"></a>00140                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sxi &gt; 0) sxidx = (int) floor(((<span class="keywordtype">float</span>) sxi + vx - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00141"></a>00141                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sxi == 0) sxidx = xidx;
<a name="l00142"></a>00142                             <span class="keywordflow">if</span> (syi &lt; 0) syidx = (int) ceil(((<span class="keywordtype">float</span>) syi + vy - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00143"></a>00143                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (syi &gt; 0) syidx = (int) floor(((<span class="keywordtype">float</span>) syi + vy - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00144"></a>00144                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (syi == 0) syidx = yidx;
<a name="l00145"></a>00145                             <span class="keywordflow">if</span> (szi &lt; 0) szidx = (int) ceil(((<span class="keywordtype">float</span>) szi + vz - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00146"></a>00146                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (szi &gt; 0) szidx = (int) floor(((<span class="keywordtype">float</span>) szi + vz - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00147"></a>00147                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (szi == 0) szidx = zidx;
<a name="l00148"></a>00148                             <span class="comment">/*double check if we are not on the already incremented grid point*/</span>
<a name="l00149"></a>00149                             <span class="keywordflow">if</span> (((sxidx != xidx) || (syidx != yidx) || (szidx != zidx))
<a name="l00150"></a>00150                                     &amp;&amp; (sxidx &gt;= 0 &amp;&amp; syidx &gt;= 0 &amp;&amp; szidx &gt;= 0 &amp;&amp; sxidx &lt; g-&gt;nx &amp;&amp; syidx &lt; g-&gt;ny &amp;&amp; szidx &lt; g-&gt;nz)) {
<a name="l00151"></a>00151                                 g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[sxidx][syidx][szidx] += incre;
<a name="l00152"></a>00152                             } <span class="comment">/*added condition if grid value already set, do not update, to better density measurements and match drug score*/</span>
<a name="l00153"></a>00153                         }
<a name="l00154"></a>00154                     }
<a name="l00155"></a>00155                 }
<a name="l00156"></a>00156             }
<a name="l00157"></a>00157             cnv = cnv-&gt;<a class="code" href="structnode__vertice.html#61b34ff349d05cc65a4d8b9e2c77ff3e">next</a>;
<a name="l00158"></a>00158         }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160         <span class="keywordflow">if</span> (xidx &lt; g-&gt;nx &amp;&amp; yidx &lt; g-&gt;ny &amp;&amp; zidx &lt; g-&gt;nz &amp;&amp; xidx &gt;= 0 &amp;&amp; yidx &gt;= 0 &amp;&amp; zidx &gt;= 0) {
<a name="l00161"></a>00161 
<a name="l00162"></a>00162             g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[xidx][yidx][zidx] += incre; <span class="comment">/*increment the already known grid point value*/</span>
<a name="l00163"></a>00163 
<a name="l00164"></a>00164         } <span class="keywordflow">else</span> fprintf(stderr, <span class="stringliteral">"\n\nWarning (oh oh!!) : Your structure is not aligned or is moving a lot. Results might not reflect what you expect. Consider first structural alignemnt\nIf your structure is moving a lot, consider to split up analysis in two distinct parts.\n\n"</span>);
<a name="l00165"></a>00165         cp = cp-&gt;<a class="code" href="structnode__pocket.html#a33c910dd9e6996001374199f250267e">next</a>;
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fa97c7e89d66d007fe7d7dda7856b691"></a><!-- doxytag: member="mdpbase.c::float_get_min_max_from_pockets" ref="fa97c7e89d66d007fe7d7dda7856b691" args="(c_lst_pockets *pockets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structs__min__max__pockets.html">s_min_max_pockets</a>* float_get_min_max_from_pockets           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *&nbsp;</td>
          <td class="paramname"> <em>pockets</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: float_get_min_max_from_pockets<p>
## SPECIFICATION: Get the absolute minimum and maximum point from pockets<p>
## PARAMETRES: @ <a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets : Chained list of pockets<p>
## RETURN: @ <a class="el" href="structs__min__max__pockets.html">s_min_max_pockets</a> : Structure containing the minimum &amp; maximum 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00397">397</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="mdpbase_8h-source.html#l00099">s_min_max_pockets::maxx</a>, <a class="el" href="mdpbase_8h-source.html#l00100">s_min_max_pockets::maxy</a>, <a class="el" href="mdpbase_8h-source.html#l00101">s_min_max_pockets::maxz</a>, <a class="el" href="mdpbase_8h-source.html#l00096">s_min_max_pockets::minx</a>, <a class="el" href="mdpbase_8h-source.html#l00097">s_min_max_pockets::miny</a>, <a class="el" href="mdpbase_8h-source.html#l00098">s_min_max_pockets::minz</a>, <a class="el" href="memhandler_8c-source.html#l00121">my_malloc()</a>, <a class="el" href="voronoi_8h-source.html#l00100">s_lst_vvertice::nvert</a>, <a class="el" href="voronoi_8h-source.html#l00095">s_lst_vvertice::vertices</a>, <a class="el" href="pocket_8h-source.html#l00094">c_lst_pockets::vertices</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>

<p>Referenced by <a class="el" href="mdpbase_8c-source.html#l00438">init_md_grid()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00397"></a>00397                                                                           {
<a name="l00398"></a>00398     <span class="keywordflow">if</span> (pockets) {
<a name="l00399"></a>00399         <span class="keywordtype">int</span> z;
<a name="l00400"></a>00400         <span class="keywordtype">float</span> minx = 50000., maxx = -50000., miny = 50000., maxy = -50000., minz = 50000., maxz = -50000.;
<a name="l00401"></a>00401         <span class="keywordtype">int</span> n = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#c6b07ac45ca65ccd944b68afd4c18bfb">nvert</a>;
<a name="l00402"></a>00402         <span class="comment">/*if there a no vertices in m before, first allocate some space*/</span>
<a name="l00403"></a>00403         <span class="keywordflow">for</span> (z = 0; z &lt; n; z++) { <span class="comment">/*loop over all vertices*/</span>
<a name="l00404"></a>00404             <span class="comment">/*store the positions and radius of the vertices*/</span>
<a name="l00405"></a>00405             <span class="keywordflow">if</span> (minx &gt; pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>) minx = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>;
<a name="l00406"></a>00406             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxx &lt; pockets-&gt;vertices-&gt;vertices[z].x)maxx = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>;
<a name="l00407"></a>00407             <span class="keywordflow">if</span> (miny &gt; pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>) miny = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>;
<a name="l00408"></a>00408             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxy &lt; pockets-&gt;vertices-&gt;vertices[z].y)maxy = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>;
<a name="l00409"></a>00409             <span class="keywordflow">if</span> (minz &gt; pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>) minz = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>;
<a name="l00410"></a>00410             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (maxz &lt; pockets-&gt;vertices-&gt;vertices[z].z)maxz = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>;
<a name="l00411"></a>00411         }
<a name="l00412"></a>00412         <a class="code" href="structs__min__max__pockets.html">s_min_max_pockets</a> *r = (<a class="code" href="structs__min__max__pockets.html">s_min_max_pockets</a> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<a class="code" href="structs__min__max__pockets.html">s_min_max_pockets</a>));
<a name="l00413"></a>00413         r-&gt;<a class="code" href="structs__min__max__pockets.html#f02c309486924fd686d3dd207baa0990">maxx</a> = maxx;
<a name="l00414"></a>00414         r-&gt;<a class="code" href="structs__min__max__pockets.html#cd3f55494da9972f48b7b5089115e92b">maxy</a> = maxy;
<a name="l00415"></a>00415         r-&gt;<a class="code" href="structs__min__max__pockets.html#2975f5fc97c243d335166d4e99d1cd08">maxz</a> = maxz;
<a name="l00416"></a>00416         r-&gt;<a class="code" href="structs__min__max__pockets.html#d651a5682cce08e603649bee049d187f">minx</a> = minx;
<a name="l00417"></a>00417         r-&gt;<a class="code" href="structs__min__max__pockets.html#2eb7e007c0159dc1feb93c318f56cdb8">miny</a> = miny;
<a name="l00418"></a>00418         r-&gt;<a class="code" href="structs__min__max__pockets.html#24d7bdef66866021361ec13d35a3fb6f">minz</a> = minz;
<a name="l00419"></a>00419         <span class="keywordflow">return</span> (r);
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421     <span class="keywordflow">return</span> (NULL);
<a name="l00422"></a>00422 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="026cc6969faf96af18e73415eca39340"></a><!-- doxytag: member="mdpbase.c::free_mdconcat" ref="026cc6969faf96af18e73415eca39340" args="(s_mdconcat *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_mdconcat           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdconcat.html">s_mdconcat</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: free_mdconcat<p>
## SPECIFICATION: Free the mdconcat structure<p>
## PARAMETRES: @ <a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m: Pointer to the structure to free<p>
## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00545">545</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00545"></a>00545                                   {
<a name="l00546"></a>00546     <span class="keywordtype">size_t</span> i;
<a name="l00547"></a>00547     <span class="keywordflow">for</span> (i = 0; i &lt; m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a>; i++) {
<a name="l00548"></a>00548         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[i]);
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550     <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>);
<a name="l00551"></a>00551     <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(m);
<a name="l00552"></a>00552 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0a8aaf97120635fb837cbe8464814ea7"></a><!-- doxytag: member="mdpbase.c::init_md_concat" ref="0a8aaf97120635fb837cbe8464814ea7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structs__mdconcat.html">s_mdconcat</a>* init_md_concat           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: init_md_concat<p>
## SPECIFICATION: Initialize the md concat (alloc)<p>
## PARAMETRES: void<p>
## RETURN: <a class="el" href="structs__mdconcat.html">s_mdconcat</a> * : the md concat structure 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00374">374</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00374"></a>00374                                  {
<a name="l00375"></a>00375     <a class="code" href="structs__mdconcat.html">s_mdconcat</a> *m = (<a class="code" href="structs__mdconcat.html">s_mdconcat</a> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<a class="code" href="structs__mdconcat.html">s_mdconcat</a>));
<a name="l00376"></a>00376     m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> = 0;
<a name="l00377"></a>00377     m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a> = NULL;
<a name="l00378"></a>00378     m-&gt;<a class="code" href="structs__mdconcat.html#3d0bb6617637bad9e6ab5a78e74b2078">n_snapshots</a> = 0;
<a name="l00379"></a>00379     <span class="keywordflow">return</span> m;
<a name="l00380"></a>00380 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3a661550596173bd65329c1ced46ef06"></a><!-- doxytag: member="mdpbase.c::init_md_grid" ref="3a661550596173bd65329c1ced46ef06" args="(c_lst_pockets *pockets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structs__mdgrid.html">s_mdgrid</a>* init_md_grid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *&nbsp;</td>
          <td class="paramname"> <em>pockets</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: init_md_grid<p>
## SPECIFICATION: Initialize the md grid (allocate + 0)<p>
## PARAMETRES: @ <a class="el" href="structs__mdconcat.html">s_mdconcat</a> *mdc: Pointer to the mdconcat structure (vertices),<p>
## RETURN: <a class="el" href="structs__mdgrid.html">s_mdgrid</a> * : the grid 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00438">438</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="mdpbase_8c-source.html#l00397">float_get_min_max_from_pockets()</a>, <a class="el" href="mdpbase_8h-source.html#l00086">s_mdgrid::gridvalues</a>, <a class="el" href="mdpbase_8h-source.html#l00065">M_MDP_CUBE_SIDE</a>, <a class="el" href="mdpbase_8h-source.html#l00064">M_MDP_GRID_RESOLUTION</a>, <a class="el" href="mdpbase_8h-source.html#l00099">s_min_max_pockets::maxx</a>, <a class="el" href="mdpbase_8h-source.html#l00100">s_min_max_pockets::maxy</a>, <a class="el" href="mdpbase_8h-source.html#l00101">s_min_max_pockets::maxz</a>, <a class="el" href="mdpbase_8h-source.html#l00096">s_min_max_pockets::minx</a>, <a class="el" href="mdpbase_8h-source.html#l00097">s_min_max_pockets::miny</a>, <a class="el" href="mdpbase_8h-source.html#l00098">s_min_max_pockets::minz</a>, <a class="el" href="memhandler_8c-source.html#l00255">my_free()</a>, <a class="el" href="memhandler_8c-source.html#l00121">my_malloc()</a>, <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::nx</a>, <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::ny</a>, <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::nz</a>, <a class="el" href="mdpbase_8h-source.html#l00087">s_mdgrid::origin</a>, and <a class="el" href="mdpbase_8h-source.html#l00089">s_mdgrid::resolution</a>.</p>

<p>Referenced by <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00438"></a>00438                                                {
<a name="l00439"></a>00439     <a class="code" href="structs__mdgrid.html">s_mdgrid</a> *g = (<a class="code" href="structs__mdgrid.html">s_mdgrid</a> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<a class="code" href="structs__mdgrid.html">s_mdgrid</a>));
<a name="l00440"></a>00440     <a class="code" href="structs__min__max__pockets.html">s_min_max_pockets</a> *mm = <a class="code" href="mdpbase_8c.html#fa97c7e89d66d007fe7d7dda7856b691">float_get_min_max_from_pockets</a>(pockets);
<a name="l00441"></a>00441     <span class="keywordtype">float</span> xmax = mm-&gt;<a class="code" href="structs__min__max__pockets.html#f02c309486924fd686d3dd207baa0990">maxx</a>;
<a name="l00442"></a>00442     <span class="keywordtype">float</span> ymax = mm-&gt;<a class="code" href="structs__min__max__pockets.html#cd3f55494da9972f48b7b5089115e92b">maxy</a>;
<a name="l00443"></a>00443     <span class="keywordtype">float</span> zmax = mm-&gt;<a class="code" href="structs__min__max__pockets.html#2975f5fc97c243d335166d4e99d1cd08">maxz</a>;
<a name="l00444"></a>00444     <span class="keywordtype">float</span> xmin = mm-&gt;<a class="code" href="structs__min__max__pockets.html#d651a5682cce08e603649bee049d187f">minx</a>;
<a name="l00445"></a>00445     <span class="keywordtype">float</span> ymin = mm-&gt;<a class="code" href="structs__min__max__pockets.html#2eb7e007c0159dc1feb93c318f56cdb8">miny</a>;
<a name="l00446"></a>00446     <span class="keywordtype">float</span> zmin = mm-&gt;<a class="code" href="structs__min__max__pockets.html#24d7bdef66866021361ec13d35a3fb6f">minz</a>;
<a name="l00447"></a>00447     <span class="keywordtype">float</span> initvalue = 0.0;
<a name="l00448"></a>00448     <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(mm);
<a name="l00449"></a>00449     <span class="keywordtype">int</span> cx, cy, cz;
<a name="l00450"></a>00450     <span class="keywordtype">float</span> span = (<a class="code" href="mdpbase_8h.html#6ac8f76875e6adfaafa8b21413658576">M_MDP_CUBE_SIDE</a> / 2.0) / <a class="code" href="mdpbase_8h.html#cad3bc8fee8c274562632ceefa313fb0">M_MDP_GRID_RESOLUTION</a>;
<a name="l00451"></a>00451     g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a> = <a class="code" href="mdpbase_8h.html#cad3bc8fee8c274562632ceefa313fb0">M_MDP_GRID_RESOLUTION</a>;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     g-&gt;<a class="code" href="structs__mdgrid.html#e0dd53dd4142fd8319b40b0da0edf27a">nx</a> = 1 + (int) (xmax + 30. * span - xmin) / (g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00454"></a>00454     g-&gt;<a class="code" href="structs__mdgrid.html#7bc6cc3285c21b21f6d5eb0e7a9499aa">ny</a> = 1 + (int) (ymax + 30. * span - ymin) / (g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00455"></a>00455     g-&gt;<a class="code" href="structs__mdgrid.html#8508a0d47d05386bd5fcc6ae8262cc30">nz</a> = 1 + (int) (zmax + 30. * span - zmin) / (g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457     g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a> = (<span class="keywordtype">float</span> ***) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<span class="keywordtype">float</span> **) * g-&gt;<a class="code" href="structs__mdgrid.html#e0dd53dd4142fd8319b40b0da0edf27a">nx</a>);
<a name="l00458"></a>00458     <span class="keywordflow">for</span> (cx = 0; cx &lt; g-&gt;<a class="code" href="structs__mdgrid.html#e0dd53dd4142fd8319b40b0da0edf27a">nx</a>; cx++) {
<a name="l00459"></a>00459         g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[cx] = (<span class="keywordtype">float</span> **) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<span class="keywordtype">float</span> *) * g-&gt;<a class="code" href="structs__mdgrid.html#7bc6cc3285c21b21f6d5eb0e7a9499aa">ny</a>);
<a name="l00460"></a>00460         <span class="keywordflow">for</span> (cy = 0; cy &lt; g-&gt;<a class="code" href="structs__mdgrid.html#7bc6cc3285c21b21f6d5eb0e7a9499aa">ny</a>; cy++) {
<a name="l00461"></a>00461             g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[cx][cy] = (<span class="keywordtype">float</span> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<span class="keywordtype">float</span>) * g-&gt;<a class="code" href="structs__mdgrid.html#8508a0d47d05386bd5fcc6ae8262cc30">nz</a>);
<a name="l00462"></a>00462             <span class="keywordflow">for</span> (cz = 0; cz &lt; g-&gt;<a class="code" href="structs__mdgrid.html#8508a0d47d05386bd5fcc6ae8262cc30">nz</a>; cz++) {
<a name="l00463"></a>00463                 g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[cx][cy][cz] = initvalue;
<a name="l00464"></a>00464 
<a name="l00465"></a>00465             }
<a name="l00466"></a>00466         }
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a> = (<span class="keywordtype">float</span> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<span class="keywordtype">float</span>) *3);
<a name="l00470"></a>00470     g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0] = xmin - 15. * span;
<a name="l00471"></a>00471     g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1] = ymin - 15. * span;
<a name="l00472"></a>00472     g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2] = zmin - 15. * span;
<a name="l00473"></a>00473     <span class="keywordflow">return</span> g;
<a name="l00474"></a>00474 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="475c8060a73d5cd6cf9e32977e0feac1"></a><!-- doxytag: member="mdpbase.c::normalize_grid" ref="475c8060a73d5cd6cf9e32977e0feac1" args="(s_mdgrid *g, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_grid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdgrid.html">s_mdgrid</a> *&nbsp;</td>
          <td class="paramname"> <em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: normalize_grid<p>
## SPECIFICATION: Normalize all grid values by the number of snapshots<p>
## PARAMETRES: @ <a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g: Grid structure @ int n : Number of snapshots ## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00348">348</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="mdpbase_8h-source.html#l00086">s_mdgrid::gridvalues</a>, <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::nx</a>, <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::ny</a>, and <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::nz</a>.</p>

<p>Referenced by <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00348"></a>00348                                         {
<a name="l00349"></a>00349     <span class="keywordtype">int</span> x, y, z;
<a name="l00350"></a>00350     <span class="keywordflow">for</span> (x = 0; x &lt; g-&gt;<a class="code" href="structs__mdgrid.html#e0dd53dd4142fd8319b40b0da0edf27a">nx</a>; x++) {
<a name="l00351"></a>00351         <span class="keywordflow">for</span> (y = 0; y &lt; g-&gt;<a class="code" href="structs__mdgrid.html#7bc6cc3285c21b21f6d5eb0e7a9499aa">ny</a>; y++) {
<a name="l00352"></a>00352             <span class="keywordflow">for</span> (z = 0; z &lt; g-&gt;<a class="code" href="structs__mdgrid.html#8508a0d47d05386bd5fcc6ae8262cc30">nz</a>; z++) {
<a name="l00353"></a>00353                 g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[x][y][z] /= (float) n;
<a name="l00354"></a>00354             }
<a name="l00355"></a>00355         }
<a name="l00356"></a>00356     }
<a name="l00357"></a>00357 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d158097a42d8f3d71016a9fdd8cdf125"></a><!-- doxytag: member="mdpbase.c::project_grid_on_atoms" ref="d158097a42d8f3d71016a9fdd8cdf125" args="(s_mdgrid *g, s_pdb *pdb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void project_grid_on_atoms           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdgrid.html">s_mdgrid</a> *&nbsp;</td>
          <td class="paramname"> <em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td>
          <td class="paramname"> <em>pdb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: project_grid_on_atoms<p>
## SPECIFICATION: Project grid values to atoms to store these into the bfactor column of the pdb<p>
## PARAMETRES: @ <a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g: Grid structure ## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00295">295</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="atom_8h-source.html#l00070">s_atm::bfactor</a>, <a class="el" href="mdpbase_8h-source.html#l00086">s_mdgrid::gridvalues</a>, <a class="el" href="rpdb_8h-source.html#l00074">s_pdb::latoms_p</a>, <a class="el" href="mdpbase_8h-source.html#l00067">M_MDP_ATOM_DENSITY_DIST</a>, <a class="el" href="mdpbase_8h-source.html#l00090">s_mdgrid::n_snapshots</a>, <a class="el" href="rpdb_8h-source.html#l00078">s_pdb::natoms</a>, <a class="el" href="mdpbase_8h-source.html#l00087">s_mdgrid::origin</a>, <a class="el" href="mdpbase_8h-source.html#l00089">s_mdgrid::resolution</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>

<p>Referenced by <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00295"></a>00295                                                     {
<a name="l00296"></a>00296     <a class="code" href="structs__atm.html">s_atm</a> *ca = NULL;
<a name="l00297"></a>00297     <span class="keywordtype">float</span> x, y, z;
<a name="l00298"></a>00298     <span class="keywordtype">int</span> ix, iy, iz;
<a name="l00299"></a>00299     <span class="keywordtype">float</span> maxix, maxiy, maxiz;
<a name="l00300"></a>00300     <span class="keywordtype">int</span> i;
<a name="l00301"></a>00301     <span class="keywordtype">float</span> density;
<a name="l00302"></a>00302     <span class="keywordtype">float</span> ngridpoints1D = (float) <a class="code" href="mdpbase_8h.html#4a17b842b54d0ce7d155a07f3dae9c66">M_MDP_ATOM_DENSITY_DIST</a> / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>;
<a name="l00303"></a>00303     for (i = 0; i &lt; pdb-&gt;<a class="code" href="structs__pdb.html#85aaf7bdb931bb303af1ca736a998b98">natoms</a>; i++) {<span class="comment">/*for all protein atoms*/</span>
<a name="l00304"></a>00304         density = 0.0;
<a name="l00305"></a>00305         ca = pdb-&gt;<a class="code" href="structs__pdb.html#4517e3a82dbf0f34e73d1865e484dbfd">latoms_p</a>[i];  <span class="comment">/*set up the current atom*/</span>
<a name="l00306"></a>00306         <span class="comment">/*get the coordinates*/</span>
<a name="l00307"></a>00307         x = ca-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>;
<a name="l00308"></a>00308         y = ca-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>;
<a name="l00309"></a>00309         z = ca-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>;
<a name="l00310"></a>00310         <span class="comment">/*nearest position of the atom in x in the grid*/</span>
<a name="l00311"></a>00311         ix = (int) floor((x - <a class="code" href="mdpbase_8h.html#4a17b842b54d0ce7d155a07f3dae9c66">M_MDP_ATOM_DENSITY_DIST</a> - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00312"></a>00312 
<a name="l00313"></a>00313         maxix = (int) ceil((x + <a class="code" href="mdpbase_8h.html#4a17b842b54d0ce7d155a07f3dae9c66">M_MDP_ATOM_DENSITY_DIST</a> - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00314"></a>00314         maxiy = (int) ceil((y + <a class="code" href="mdpbase_8h.html#4a17b842b54d0ce7d155a07f3dae9c66">M_MDP_ATOM_DENSITY_DIST</a> - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00315"></a>00315         maxiz = (int) ceil((z + <a class="code" href="mdpbase_8h.html#4a17b842b54d0ce7d155a07f3dae9c66">M_MDP_ATOM_DENSITY_DIST</a> - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00316"></a>00316         <span class="keywordflow">while</span> (ix &lt;= maxix &amp;&amp; g-&gt;nx &gt; ix) {
<a name="l00317"></a>00317             iy = (int) floor((y - <a class="code" href="mdpbase_8h.html#4a17b842b54d0ce7d155a07f3dae9c66">M_MDP_ATOM_DENSITY_DIST</a> - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00318"></a>00318             <span class="keywordflow">while</span> (iy &lt;= maxiy &amp;&amp; g-&gt;ny &gt; iy) {
<a name="l00319"></a>00319                 iz = (int) floor((z - <a class="code" href="mdpbase_8h.html#4a17b842b54d0ce7d155a07f3dae9c66">M_MDP_ATOM_DENSITY_DIST</a> - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00320"></a>00320                 <span class="keywordflow">while</span> (iz &lt;= maxiz &amp;&amp; g-&gt;nz &gt; iz) {
<a name="l00321"></a>00321                     density += g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[ix][iy][iz];
<a name="l00322"></a>00322                     iz++;
<a name="l00323"></a>00323                 }
<a name="l00324"></a>00324                 iy++;
<a name="l00325"></a>00325             }
<a name="l00326"></a>00326             ix++;
<a name="l00327"></a>00327         }
<a name="l00328"></a>00328         <span class="comment">/*transform the density to something more contrasted for the bfactor column*/</span>
<a name="l00329"></a>00329         ca-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a> = log(1 + density / (ngridpoints1D) / (<span class="keywordtype">float</span>) g-&gt;<a class="code" href="structs__mdgrid.html#7b77c647c68686186aa64afdd9675887">n_snapshots</a>);
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1bab69995238614fbcaa0121c91936f7"></a><!-- doxytag: member="mdpbase.c::realloc_md_concat" ref="1bab69995238614fbcaa0121c91936f7" args="(s_mdconcat *m, size_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void realloc_md_concat           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdconcat.html">s_mdconcat</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: realloc_md_concat<p>
## SPECIFICATION: Reallocate memory for the md concat structure (to add a new snapshot)<p>
## PARAMETRES: @ <a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m: Pointer to the structure to free, @ size_t n: Number of vertices in the snapshot to add to m<p>
## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00518">518</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>Referenced by <a class="el" href="mdpbase_8c-source.html#l00070">store_vertice_positions()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00518"></a>00518                                                 {
<a name="l00519"></a>00519     <span class="keywordtype">size_t</span> z;
<a name="l00520"></a>00520     m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a> = (<span class="keywordtype">float</span> **) <a class="code" href="memhandler_8c.html#ede15d67c845c05e9b2bfb59b8ab6cf7">my_realloc</a>(m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>, sizeof (<span class="keywordtype">float</span> *) *(m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> + n));
<a name="l00521"></a>00521     <span class="keywordflow">for</span> (z = 0; z &lt; n; z++) {
<a name="l00522"></a>00522         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> + z] = (<span class="keywordtype">float</span> *) <a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span> (<span class="keywordtype">float</span>) *4);
<a name="l00523"></a>00523         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> + z][0] = 0.0;
<a name="l00524"></a>00524         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> + z][1] = 0.0;
<a name="l00525"></a>00525         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> + z][2] = 0.0;
<a name="l00526"></a>00526         m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> + z][3] = 0.0;
<a name="l00527"></a>00527     }
<a name="l00528"></a>00528     m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> += n;
<a name="l00529"></a>00529 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="797f3a7e29293b29134777ed5d0fd30b"></a><!-- doxytag: member="mdpbase.c::reset_grid" ref="797f3a7e29293b29134777ed5d0fd30b" args="(s_mdgrid *g)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset_grid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdgrid.html">s_mdgrid</a> *&nbsp;</td>
          <td class="paramname"> <em>g</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: reset_grid<p>
## SPECIFICATION: Reset all grid values to 0<p>
## PARAMETRES: @ <a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g: Grid structure ## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00269">269</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="mdpbase_8h-source.html#l00086">s_mdgrid::gridvalues</a>, <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::nx</a>, <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::ny</a>, and <a class="el" href="mdpbase_8h-source.html#l00088">s_mdgrid::nz</a>.</p>

<p>Referenced by <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00269"></a>00269                              {
<a name="l00270"></a>00270     <span class="keywordtype">int</span> x, y, z;
<a name="l00271"></a>00271     <span class="keywordflow">for</span> (x = 0; x &lt; g-&gt;<a class="code" href="structs__mdgrid.html#e0dd53dd4142fd8319b40b0da0edf27a">nx</a>; x++) {
<a name="l00272"></a>00272         <span class="keywordflow">for</span> (y = 0; y &lt; g-&gt;<a class="code" href="structs__mdgrid.html#7bc6cc3285c21b21f6d5eb0e7a9499aa">ny</a>; y++) {
<a name="l00273"></a>00273             <span class="keywordflow">for</span> (z = 0; z &lt; g-&gt;<a class="code" href="structs__mdgrid.html#8508a0d47d05386bd5fcc6ae8262cc30">nz</a>; z++) {
<a name="l00274"></a>00274                 g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[x][y][z] = 0.0;
<a name="l00275"></a>00275             }
<a name="l00276"></a>00276         }
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ec2d0f5a143a25df23d35ffc8382f008"></a><!-- doxytag: member="mdpbase.c::store_vertice_positions" ref="ec2d0f5a143a25df23d35ffc8382f008" args="(s_mdconcat *m, c_lst_pockets *pockets)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void store_vertice_positions           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdconcat.html">s_mdconcat</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *&nbsp;</td>
          <td class="paramname"> <em>pockets</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: store_vertice_positions<p>
## SPECIFICATION: Store vertice positions of current pockets in the mdconcat structure<p>
## PARAMETRES: @ <a class="el" href="structs__mdconcat.html">s_mdconcat</a> *m: Pointer to the mdconcat structure (vertices), @ <a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets : Pointer to all pockets found by fpocket<p>
## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00070">70</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="mdpbase_8c-source.html#l00490">alloc_first_md_concat()</a>, <a class="el" href="mdpbase_8h-source.html#l00077">s_mdconcat::n_vertpos</a>, <a class="el" href="voronoi_8h-source.html#l00100">s_lst_vvertice::nvert</a>, <a class="el" href="voronoi_8h-source.html#l00075">s_vvertice::ray</a>, <a class="el" href="mdpbase_8c-source.html#l00518">realloc_md_concat()</a>, <a class="el" href="voronoi_8h-source.html#l00095">s_lst_vvertice::vertices</a>, <a class="el" href="pocket_8h-source.html#l00094">c_lst_pockets::vertices</a>, <a class="el" href="mdpbase_8h-source.html#l00076">s_mdconcat::vertpos</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00070"></a>00070                                                                     {
<a name="l00071"></a>00071     <span class="keywordflow">if</span> (pockets) {
<a name="l00072"></a>00072         <span class="keywordtype">int</span> z;
<a name="l00073"></a>00073         <span class="keywordtype">int</span> n = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#c6b07ac45ca65ccd944b68afd4c18bfb">nvert</a>;
<a name="l00074"></a>00074         <span class="keywordtype">size_t</span> old_n = m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a>;
<a name="l00075"></a>00075         <span class="comment">/*if there a no vertices in m before, first allocate some space*/</span>
<a name="l00076"></a>00076         <span class="keywordflow">if</span> (m-&gt;<a class="code" href="structs__mdconcat.html#48ac27d4b7bd833a77bd05187a5344a8">n_vertpos</a> == 0) <a class="code" href="mdpbase_8c.html#68058a8dac54dfcb290df9a1bd96200a">alloc_first_md_concat</a>(m, n);
<a name="l00077"></a>00077         <span class="keywordflow">else</span> <a class="code" href="mdpbase_8c.html#1bab69995238614fbcaa0121c91936f7">realloc_md_concat</a>(m, n); <span class="comment">/*else, reallocate the object size*/</span>
<a name="l00078"></a>00078         <span class="keywordflow">for</span> (z = 0; z &lt; n; z++) { <span class="comment">/*loop over all vertices*/</span>
<a name="l00079"></a>00079             <span class="comment">/*store the positions and radius of the vertices*/</span>
<a name="l00080"></a>00080             m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[old_n + z][0] = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>;
<a name="l00081"></a>00081             m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[old_n + z][1] = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>;
<a name="l00082"></a>00082             m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[old_n + z][2] = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>;
<a name="l00083"></a>00083             m-&gt;<a class="code" href="structs__mdconcat.html#26cdf86a081c6bb080fc1e2330388e08">vertpos</a>[old_n + z][3] = pockets-&gt;<a class="code" href="structc__lst__pockets.html#8d86cfec23ef9aa0079cf8258b39863e">vertices</a>-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[z].<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a>;
<a name="l00084"></a>00084         }
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b17b0eaff6d9e3509adec9d37e3ba766"></a><!-- doxytag: member="mdpbase.c::update_md_grid" ref="b17b0eaff6d9e3509adec9d37e3ba766" args="(s_mdgrid *g, s_mdgrid *refg, c_lst_pockets *pockets, s_mdparams *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_md_grid           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__mdgrid.html">s_mdgrid</a> *&nbsp;</td>
          <td class="paramname"> <em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__mdgrid.html">s_mdgrid</a> *&nbsp;</td>
          <td class="paramname"> <em>refg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *&nbsp;</td>
          <td class="paramname"> <em>pockets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__mdparams.html">s_mdparams</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: update_md_dens_grid<p>
## SPECIFICATION: Do the actual grid calculation (count number of vertices near a grid point)<p>
## PARAMETRES: @ <a class="el" href="structs__mdgrid.html">s_mdgrid</a> *g: Grid structure @ <a class="el" href="structc__lst__pockets.html">c_lst_pockets</a> *pockets : Pocket chained list @ <a class="el" href="structs__mdparams.html">s_mdparams</a> *par : Parameters of mdpocket ## RETURN: void 
<p>Definition at line <a class="el" href="mdpbase_8c-source.html#l00184">184</a> of file <a class="el" href="mdpbase_8c-source.html">mdpbase.c</a>.</p>

<p>References <a class="el" href="descriptors_8h-source.html#l00099">s_desc::drug_score</a>, <a class="el" href="voronoi__lst_8h-source.html#l00064">c_lst_vertices::first</a>, <a class="el" href="pocket_8h-source.html#l00089">c_lst_pockets::first</a>, <a class="el" href="mdparams_8h-source.html#l00139">s_mdparams::flag_scoring</a>, <a class="el" href="mdpbase_8h-source.html#l00086">s_mdgrid::gridvalues</a>, <a class="el" href="mdpbase_8h-source.html#l00065">M_MDP_CUBE_SIDE</a>, <a class="el" href="pocket_8h-source.html#l00080">node_pocket::next</a>, <a class="el" href="voronoi__lst_8h-source.html#l00056">node_vertice::next</a>, <a class="el" href="mdpbase_8h-source.html#l00087">s_mdgrid::origin</a>, <a class="el" href="pocket_8h-source.html#l00061">s_pocket::pdesc</a>, <a class="el" href="pocket_8h-source.html#l00082">node_pocket::pocket</a>, <a class="el" href="mdpbase_8h-source.html#l00089">s_mdgrid::resolution</a>, <a class="el" href="pocket_8h-source.html#l00063">s_pocket::v_lst</a>, <a class="el" href="voronoi__lst_8h-source.html#l00058">node_vertice::vertice</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>

<p>Referenced by <a class="el" href="mdpocket_8c-source.html#l00089">mdpocket_detect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00184"></a>00184                                                                                           {
<a name="l00185"></a>00185     <span class="keywordtype">int</span> xidx = 0, yidx = 0, zidx = 0; <span class="comment">/*direct indices of the positions in the grid*/</span>
<a name="l00186"></a>00186     <span class="keywordtype">int</span> sxidx = 0, syidx = 0, szidx = 0; <span class="comment">/*indices nearby xidx,yidx,zidx that are within M_MDP_CUBE_SIDE of this point*/</span>
<a name="l00187"></a>00187     <span class="keywordtype">int</span> sxi = 0, syi = 0, szi = 0;
<a name="l00188"></a>00188     <span class="keywordtype">float</span> vx, vy, vz;
<a name="l00189"></a>00189     <span class="keywordtype">float</span> incre = 1.0;
<a name="l00190"></a>00190     <a class="code" href="structnode__pocket.html">node_pocket</a> *cp = NULL;
<a name="l00191"></a>00191     <a class="code" href="structs__pocket.html">s_pocket</a> *pocket = NULL;
<a name="l00192"></a>00192     <a class="code" href="structnode__vertice.html">node_vertice</a> *cnv = NULL;
<a name="l00193"></a>00193     <a class="code" href="structs__vvertice.html">s_vvertice</a> *cv = NULL;
<a name="l00194"></a>00194     <span class="keywordtype">int</span> s = (int) (((<span class="keywordtype">float</span>) <a class="code" href="mdpbase_8h.html#6ac8f76875e6adfaafa8b21413658576">M_MDP_CUBE_SIDE</a> / 2.0) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>); <span class="comment">/*possible stepsize (resolution dependent) in the discrete grid*/</span>
<a name="l00195"></a>00195     <span class="comment">/*loop over all known vertices and CALCULATE the grid positions and increment grid values by 1*/</span>
<a name="l00196"></a>00196     <span class="comment">/*important : no distance calculations are done here, thus this routine is very fast*/</span>
<a name="l00197"></a>00197     cp = pockets-&gt;<a class="code" href="structc__lst__pockets.html#cf82eb35ce757228759a9af7675f5ad9">first</a>;
<a name="l00198"></a>00198     <span class="keywordflow">while</span> (cp) { <span class="comment">/*loop over pockets*/</span>
<a name="l00199"></a>00199         pocket = cp-&gt;<a class="code" href="structnode__pocket.html#8dbdbb50f893fa45bba2d8c03aff6553">pocket</a>;
<a name="l00200"></a>00200         cnv = pocket-&gt;<a class="code" href="structs__pocket.html#cf07f539404d23c1956373f8c93a4fcc">v_lst</a>-&gt;<a class="code" href="structc__lst__vertices.html#72562067d308bcfcf32605e112e30c1a">first</a>;
<a name="l00201"></a>00201         <span class="comment">/*if(par-&gt;flag_scoring) incre=pocket-&gt;score;*/</span>
<a name="l00202"></a>00202         <span class="keywordflow">if</span> (par-&gt;<a class="code" href="structs__mdparams.html#dc8ce867fa68a31df1f58de97341ddc6">flag_scoring</a>) incre = pocket-&gt;<a class="code" href="structs__pocket.html#aba02d3ca1a41adf62ad69884c85fed5">pdesc</a>-&gt;<a class="code" href="structs__desc.html#27317d1ebeb59e4ea4ebdbca11069c3c">drug_score</a>;
<a name="l00203"></a>00203         <span class="keywordflow">while</span> (cnv) { <span class="comment">/*loop over vertices*/</span>
<a name="l00204"></a>00204             cv = cnv-&gt;<a class="code" href="structnode__vertice.html#7e7063f6403dfd8f0a8f83462e27729b">vertice</a>;
<a name="l00205"></a>00205             vx = cv-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>; <span class="comment">/*tmp the vertice position*/</span>
<a name="l00206"></a>00206             vy = cv-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>;
<a name="l00207"></a>00207             vz = cv-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>;
<a name="l00208"></a>00208             xidx = (int) roundf((vx - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>); <span class="comment">/*calculate the nearest grid point internal coordinates*/</span>
<a name="l00209"></a>00209             yidx = (int) roundf((vy - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00210"></a>00210             zidx = (int) roundf((vz - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00211"></a>00211             <span class="comment">/*we use a cube of M_MDP_CUBE_SIDE**3 volume to check if there are grid points nearby,</span>
<a name="l00212"></a>00212 <span class="comment">             *thus a check in the neighbourhood is performed here...this looks a bit awful and should be changed later on*/</span>
<a name="l00213"></a>00213 
<a name="l00214"></a>00214             <span class="keywordflow">for</span> (sxi = -s; sxi &lt;= s; sxi++) {
<a name="l00215"></a>00215                 <span class="keywordflow">for</span> (syi = -s; syi &lt;= s; syi++) {
<a name="l00216"></a>00216                     <span class="keywordflow">for</span> (szi = -s; szi &lt;= s; szi++) {
<a name="l00217"></a>00217                         <span class="comment">/*check if we are not on the point xidx,yidx, zidx....the square sum is just a little trick*/</span>
<a name="l00218"></a>00218                         <span class="keywordflow">if</span> ((sxi * sxi + syi * syi + szi * szi) != 0) {
<a name="l00219"></a>00219                             <span class="comment">/*next we have to check in a discrete manner if we can include a new grid point or not.*/</span>
<a name="l00220"></a>00220                             <span class="keywordflow">if</span> (sxi &lt; 0) sxidx = (int) ceil(((<span class="keywordtype">float</span>) sxi + vx - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00221"></a>00221                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sxi &gt; 0) sxidx = (int) floor(((<span class="keywordtype">float</span>) sxi + vx - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[0]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00222"></a>00222                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sxi == 0) sxidx = xidx;
<a name="l00223"></a>00223                             <span class="keywordflow">if</span> (syi &lt; 0) syidx = (int) ceil(((<span class="keywordtype">float</span>) syi + vy - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00224"></a>00224                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (syi &gt; 0) syidx = (int) floor(((<span class="keywordtype">float</span>) syi + vy - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[1]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00225"></a>00225                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (syi == 0) syidx = yidx;
<a name="l00226"></a>00226                             <span class="keywordflow">if</span> (szi &lt; 0) szidx = (int) ceil(((<span class="keywordtype">float</span>) szi + vz - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00227"></a>00227                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (szi &gt; 0) szidx = (int) floor(((<span class="keywordtype">float</span>) szi + vz - g-&gt;<a class="code" href="structs__mdgrid.html#83943f04b48a6c7b620d5bdc9789dca8">origin</a>[2]) / g-&gt;<a class="code" href="structs__mdgrid.html#94dd10e0212b99431ccf16d94806444e">resolution</a>);
<a name="l00228"></a>00228                             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (szi == 0) szidx = zidx;
<a name="l00229"></a>00229                             <span class="comment">/*double check if we are not on the already incremented grid point*/</span>
<a name="l00230"></a>00230                             <span class="keywordflow">if</span> (((sxidx != xidx) || (syidx != yidx) || (szidx != zidx))
<a name="l00231"></a>00231                                     &amp;&amp; (sxidx &gt;= 0 &amp;&amp; syidx &gt;= 0 &amp;&amp; szidx &gt;= 0 &amp;&amp; sxidx &lt; g-&gt;nx &amp;&amp; syidx &lt; g-&gt;ny &amp;&amp; szidx &lt; g-&gt;nz)) {
<a name="l00232"></a>00232                                 <span class="keywordflow">if</span> (refg-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[sxidx][syidx][szidx] &lt; 1.0) {
<a name="l00233"></a>00233                                     g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[sxidx][syidx][szidx] += incre;
<a name="l00234"></a>00234                                     refg-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[sxidx][syidx][szidx] = 1.0;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236                                 }
<a name="l00237"></a>00237                             } <span class="comment">/*added condition if grid value already set, do not update, to better density measurements and match drug score*/</span>
<a name="l00238"></a>00238                         }
<a name="l00239"></a>00239                     }
<a name="l00240"></a>00240                 }
<a name="l00241"></a>00241             }
<a name="l00242"></a>00242             cnv = cnv-&gt;<a class="code" href="structnode__vertice.html#61b34ff349d05cc65a4d8b9e2c77ff3e">next</a>;
<a name="l00243"></a>00243         }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <span class="keywordflow">if</span> (xidx &lt; g-&gt;nx &amp;&amp; yidx &lt; g-&gt;ny &amp;&amp; zidx &lt; g-&gt;nz &amp;&amp; xidx &gt;= 0 &amp;&amp; yidx &gt;= 0 &amp;&amp; zidx &gt;= 0) {
<a name="l00246"></a>00246             <span class="keywordflow">if</span> (refg-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[xidx][yidx][zidx] &lt; 1.0) {
<a name="l00247"></a>00247                 g-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[xidx][yidx][zidx] += incre; <span class="comment">/*increment the already known grid point value*/</span>
<a name="l00248"></a>00248                 refg-&gt;<a class="code" href="structs__mdgrid.html#d89b7dcf1b497bfbffd84ee4fdd31f42">gridvalues</a>[xidx][yidx][zidx] = 1.0;
<a name="l00249"></a>00249             }
<a name="l00250"></a>00250         } <span class="keywordflow">else</span> fprintf(stderr, <span class="stringliteral">"\n\nWarning (oh oh!!) : Your structure is not aligned or is moving a lot. Results might not reflect what you expect. Consider first structural alignemnt\nIf your structure is moving a lot, consider to split up analysis in two distinct parts.\n\n"</span>);
<a name="l00251"></a>00251         cp = cp-&gt;<a class="code" href="structnode__pocket.html#a33c910dd9e6996001374199f250267e">next</a>;
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253     <span class="comment">//return g;</span>
<a name="l00254"></a>00254 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 7 16:44:23 2010 for fpocket by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
