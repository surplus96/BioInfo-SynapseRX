<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fpocket: atom.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<img src="fpocket_logo_small.png" width="545" height="150">
<!-- Generated by Doxygen 1.5.6 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>atom.h File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;ctype.h&gt;</code><br>
<code>#include &quot;<a class="el" href="utils_8h-source.html">utils.h</a>&quot;</code><br>

<p>
<a href="atom_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structs__atm.html">s_atm</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="atom_8h.html#fa83a33583c67b9a3a4439b14000b983">get_mol_mass</a> (<a class="el" href="structs__atm.html">s_atm</a> *latoms, int natoms)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="atom_8h.html#6c124482d4ea1d4956cb095413e4b3af">get_mol_mass_ptr</a> (<a class="el" href="structs__atm.html">s_atm</a> **latoms, int natoms)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="atom_8h.html#6648ca5bb9d7384c43dda5156e333f24">set_mol_barycenter_ptr</a> (<a class="el" href="structs__atm.html">s_atm</a> **latoms, int natoms, float bary[3])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="atom_8h.html#d0f577a82cfdb135f707700c2b84e6a5">get_mol_volume_ptr</a> (<a class="el" href="structs__atm.html">s_atm</a> **atoms, int natoms, int niter)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="atom_8h.html#a72221368b25d51716e4d59f02a8d753">is_in_lst_atm</a> (<a class="el" href="structs__atm.html">s_atm</a> **lst_atm, int nb_atm, int atm_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="atom_8h.html#29b02d9d40f326871aa70623cdd97556">atm_corsp</a> (<a class="el" href="structs__atm.html">s_atm</a> **al1, int nl1, <a class="el" href="structs__atm.html">s_atm</a> **pocket_neigh, int nal2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="atom_8h.html#9c0033f44cb65046ce5209b269da11d7">print_atoms</a> (FILE *f, <a class="el" href="structs__atm.html">s_atm</a> *atoms, int natoms)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="29b02d9d40f326871aa70623cdd97556"></a><!-- doxytag: member="atom.h::atm_corsp" ref="29b02d9d40f326871aa70623cdd97556" args="(s_atm **al1, int nl1, s_atm **pocket_neigh, int nal2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float atm_corsp           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> **&nbsp;</td>
          <td class="paramname"> <em>al1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nal1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> **&nbsp;</td>
          <td class="paramname"> <em>al2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nal2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: atm_corsp<p>
## SPECIFICATION: Calculate correspondance between two list of atoms, using the first list as reference.<p>
## PARAMETRES: @ <a class="el" href="structs__atm.html">s_atm</a> **al1 : First list @ int nal1 : Number of atoms of the first list @ <a class="el" href="structs__atm.html">s_atm</a> **al2 : Second list @ int nal2 : Number of atoms of the second list<p>
## RETURN: float: % of atoms of the first list present in the second list 
<p>Definition at line <a class="el" href="atom_8c-source.html#l00287">287</a> of file <a class="el" href="atom_8c-source.html">atom.c</a>.</p>

<p>References <a class="el" href="atom_8h-source.html#l00063">s_atm::id</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::name</a>, and <a class="el" href="atom_8h-source.html#l00063">s_atm::res_id</a>.</p>

<p>Referenced by <a class="el" href="tpocket_8c-source.html#l00661">check_pockets()</a>, and <a class="el" href="dpocket_8c-source.html#l00184">desc_pocket()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00288"></a>00288 {
<a name="l00289"></a>00289         <span class="keywordtype">int</span> i, j,
<a name="l00290"></a>00290                 nb_atm_found = 0 ;
<a name="l00291"></a>00291         <a class="code" href="structs__atm.html">s_atm</a> *cural = NULL,
<a name="l00292"></a>00292                   *curap ;
<a name="l00293"></a>00293         
<a name="l00294"></a>00294         <span class="keywordflow">if</span>(nal1 &lt;=0 || nal2 &lt;= 0){
<a name="l00295"></a>00295                 <span class="keywordflow">return</span> 0.0 ;
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298         <span class="keywordflow">for</span>(i = 0 ; i &lt; nal1 ; i++) {
<a name="l00299"></a>00299                 <span class="keywordflow">for</span>(j = 0 ; j &lt; nal2 ; j++) {
<a name="l00300"></a>00300                         cural = al1[i] ;
<a name="l00301"></a>00301                         curap = al2[j] ;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303                         <span class="keywordflow">if</span>(curap-&gt;res_id == cural-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a> &amp;&amp; 
<a name="l00304"></a>00304                         ( (curap-&gt;id == cural-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>) || strcmp(cural-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, curap-&gt;name) == 0 ) ) {
<a name="l00305"></a>00305                                 nb_atm_found++ ;
<a name="l00306"></a>00306                                 break ;
<a name="l00307"></a>00307                         }
<a name="l00308"></a>00308                 }
<a name="l00309"></a>00309         }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         
<a name="l00312"></a>00312         <span class="keywordflow">return</span> ((<span class="keywordtype">float</span>)nb_atm_found)/((float)nal1)*100.0 ;
<a name="l00313"></a>00313 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fa83a33583c67b9a3a4439b14000b983"></a><!-- doxytag: member="atom.h::get_mol_mass" ref="fa83a33583c67b9a3a4439b14000b983" args="(s_atm *latoms, int natoms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float get_mol_mass           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> *&nbsp;</td>
          <td class="paramname"> <em>latoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>natoms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: get_mol_mass<p>
## SPECIFICATION: Calculate mass of a molecule represented by a list of atoms. (structure) Perform a simple sum of atoms mass.<p>
## PARAMETRES: @ <a class="el" href="structs__atm.html">s_atm</a> *atoms : List of atoms structures @ int natoms : Number of atoms<p>
## RETURN: float: mass of the molecule 
<p>Definition at line <a class="el" href="atom_8c-source.html#l00085">85</a> of file <a class="el" href="atom_8c-source.html">atom.c</a>.</p>

<p>References <a class="el" href="atom_8h-source.html#l00070">s_atm::mass</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00086"></a>00086 {
<a name="l00087"></a>00087         <span class="keywordtype">float</span> mass = 00.0 ;
<a name="l00088"></a>00088         <span class="keywordtype">int</span> i ;
<a name="l00089"></a>00089         <span class="keywordflow">if</span>(latoms) {
<a name="l00090"></a>00090                 <span class="keywordflow">for</span>(i = 0 ; i &lt; natoms ; i++) {
<a name="l00091"></a>00091                         mass += latoms[i].<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> ;
<a name="l00092"></a>00092                 }
<a name="l00093"></a>00093         }
<a name="l00094"></a>00094         <span class="keywordflow">return</span> mass ; 
<a name="l00095"></a>00095 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6c124482d4ea1d4956cb095413e4b3af"></a><!-- doxytag: member="atom.h::get_mol_mass_ptr" ref="6c124482d4ea1d4956cb095413e4b3af" args="(s_atm **latoms, int natoms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float get_mol_mass_ptr           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> **&nbsp;</td>
          <td class="paramname"> <em>latoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>natoms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: get_mol_mass_ptr<p>
## SPECIFICATION: Same as previous, but using different input type (array of pointers)<p>
## PARAMETRES: @ <a class="el" href="structs__atm.html">s_atm</a> **atoms : List of pointers to atom structures @ int natoms : Number of atoms<p>
## RETURN: float: mass of the molecule 
<p>Definition at line <a class="el" href="atom_8c-source.html#l00112">112</a> of file <a class="el" href="atom_8c-source.html">atom.c</a>.</p>

<p>References <a class="el" href="atom_8h-source.html#l00070">s_atm::mass</a>.</p>

<p>Referenced by <a class="el" href="tpocket_8c-source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00113"></a>00113 {
<a name="l00114"></a>00114         <span class="keywordtype">float</span> mass = 00.0 ;
<a name="l00115"></a>00115         <span class="keywordtype">int</span> i ;
<a name="l00116"></a>00116         <span class="keywordflow">if</span>(latoms) {
<a name="l00117"></a>00117                 
<a name="l00118"></a>00118                 <span class="keywordflow">for</span>(i = 0 ; i &lt; natoms ; i++) {
<a name="l00119"></a>00119                         mass += latoms[i]-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a> ;
<a name="l00120"></a>00120                 }
<a name="l00121"></a>00121         }
<a name="l00122"></a>00122         <span class="keywordflow">return</span> mass ; 
<a name="l00123"></a>00123 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d0f577a82cfdb135f707700c2b84e6a5"></a><!-- doxytag: member="atom.h::get_mol_volume_ptr" ref="d0f577a82cfdb135f707700c2b84e6a5" args="(s_atm **atoms, int natoms, int niter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float get_mol_volume_ptr           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> **&nbsp;</td>
          <td class="paramname"> <em>atoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>natoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>niter</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: get_mol_volume_ptr<p>
## SPECIFICATION: Get an monte carlo approximation of the volume occupied by the atoms given in argument (list of pointers).<p>
## PARAMETRES: @ <a class="el" href="structs__atm.html">s_atm</a> **atoms : List of pointer to atoms @ int natoms : Number of atoms @ int niter : Number of monte carlo iteration to perform<p>
## RETURN: float: calculated volume (approximation). 
<p>Definition at line <a class="el" href="atom_8c-source.html#l00179">179</a> of file <a class="el" href="atom_8c-source.html">atom.c</a>.</p>

<p>References <a class="el" href="atom_8h-source.html#l00070">s_atm::radius</a>, <a class="el" href="utils_8c-source.html#l00123">rand_uniform()</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>

<p>Referenced by <a class="el" href="dpocket_8c-source.html#l00184">desc_pocket()</a>, and <a class="el" href="tpocket_8c-source.html#l00440">test_set()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00180"></a>00180 {
<a name="l00181"></a>00181         <span class="keywordtype">int</span> i = 0, j = 0,
<a name="l00182"></a>00182                 nb_in = 0;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <span class="keywordtype">float</span> xmin = 0.0, xmax = 0.0,
<a name="l00185"></a>00185                   ymin = 0.0, ymax = 0.0,
<a name="l00186"></a>00186                   zmin = 0.0, zmax = 0.0,
<a name="l00187"></a>00187                   xtmp = 0.0, ytmp = 0.0, ztmp = 0.0,
<a name="l00188"></a>00188                   xr   = 0.0, yr   = 0.0, zr   = 0.0,
<a name="l00189"></a>00189                   vbox = 0.0 ;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         <a class="code" href="structs__atm.html">s_atm</a> *acur = NULL ;
<a name="l00192"></a>00192 
<a name="l00193"></a>00193         <span class="comment">/* First, search extrems coordinates to get a contour box of the molecule */</span>
<a name="l00194"></a>00194         <span class="keywordflow">for</span>(i = 0 ; i &lt; natoms ; i++) {
<a name="l00195"></a>00195                 acur = atoms[i] ;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197                 <span class="keywordflow">if</span>(i == 0) {
<a name="l00198"></a>00198                         xmin = acur-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a> - acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> ; xmax = acur-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a> + acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> ;
<a name="l00199"></a>00199                         ymin = acur-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> - acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> ; ymax = acur-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> + acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> ;
<a name="l00200"></a>00200                         zmin = acur-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a> - acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> ; zmax = acur-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a> + acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a> ;
<a name="l00201"></a>00201                 }
<a name="l00202"></a>00202                 <span class="keywordflow">else</span> {
<a name="l00203"></a>00203                 <span class="comment">/* Update the minimum and maximum extreme point */</span>
<a name="l00204"></a>00204                         <span class="keywordflow">if</span>(xmin &gt; (xtmp = acur-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a> - acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>)) xmin = xtmp ;
<a name="l00205"></a>00205                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(xmax &lt; (xtmp = acur-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a> + acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>)) xmax = xtmp ;
<a name="l00206"></a>00206         
<a name="l00207"></a>00207                         <span class="keywordflow">if</span>(ymin &gt; (ytmp = acur-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> - acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>)) ymin = ytmp ;
<a name="l00208"></a>00208                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ymax &lt; (ytmp = acur-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> + acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>)) ymax = ytmp ;
<a name="l00209"></a>00209         
<a name="l00210"></a>00210                         <span class="keywordflow">if</span>(zmin &gt; (ztmp = acur-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a> - acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>)) zmin = ztmp ;
<a name="l00211"></a>00211                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(zmax &lt; (ztmp = acur-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a> + acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>)) zmax = ztmp ;
<a name="l00212"></a>00212                 }
<a name="l00213"></a>00213         }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215         <span class="comment">/* Next calculate the contour box volume */</span>
<a name="l00216"></a>00216         vbox = (xmax - xmin)*(ymax - ymin)*(zmax - zmin) ;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="comment">/* Then apply monte carlo approximation of the volume.   */</span>
<a name="l00219"></a>00219         <span class="keywordflow">for</span>(i = 0 ; i &lt; niter ; i++) {
<a name="l00220"></a>00220                 xr = <a class="code" href="utils_8c.html#5492196e16ed2d16bae1df8483ef79ed">rand_uniform</a>(xmin, xmax) ;
<a name="l00221"></a>00221                 yr = <a class="code" href="utils_8c.html#5492196e16ed2d16bae1df8483ef79ed">rand_uniform</a>(ymin, ymax) ;
<a name="l00222"></a>00222                 zr = <a class="code" href="utils_8c.html#5492196e16ed2d16bae1df8483ef79ed">rand_uniform</a>(zmin, zmax) ;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224                 <span class="keywordflow">for</span>(j = 0 ; j &lt; natoms ; j++) {
<a name="l00225"></a>00225                         acur = atoms[j] ;
<a name="l00226"></a>00226                         xtmp = acur-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a> - xr ;
<a name="l00227"></a>00227                         ytmp = acur-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> - yr ;
<a name="l00228"></a>00228                         ztmp = acur-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a> - zr ;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230                 <span class="comment">/* Compare r^2 and dist(center, random_point)^2 */</span>
<a name="l00231"></a>00231                         <span class="keywordflow">if</span>((acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>*acur-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>) &gt; (xtmp*xtmp + ytmp*ytmp + ztmp*ztmp)) {
<a name="l00232"></a>00232                         <span class="comment">/* The point is inside one of the vertice!! */</span>
<a name="l00233"></a>00233                                 nb_in ++ ; break ;
<a name="l00234"></a>00234                         }
<a name="l00235"></a>00235                 }
<a name="l00236"></a>00236         }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         <span class="comment">/* Ok lets just return the volume Vpok = Nb_in/Niter*Vbox */</span>
<a name="l00239"></a>00239         <span class="keywordflow">return</span> ((<span class="keywordtype">float</span>)nb_in)/((float)niter)*vbox;
<a name="l00240"></a>00240 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a72221368b25d51716e4d59f02a8d753"></a><!-- doxytag: member="atom.h::is_in_lst_atm" ref="a72221368b25d51716e4d59f02a8d753" args="(s_atm **lst_atm, int nb_atm, int atm_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_in_lst_atm           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> **&nbsp;</td>
          <td class="paramname"> <em>lst_atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nb_atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>atm_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: is_in_lst_atm<p>
## SPECIFICATION: Says wether an atom of id atm_id is in a list of atoms or not<p>
## PARAMETRES: @ <a class="el" href="structs__atm.html">s_atm</a> **lst_atm : List of atoms @ int nb_atms : Number of atoms in the list @ int atm_id : ID of the atom to look for.<p>
## RETURN: 1 if the atom is in the tab, 0 if not 
<p>Definition at line <a class="el" href="atom_8c-source.html#l00258">258</a> of file <a class="el" href="atom_8c-source.html">atom.c</a>.</p>

<p>Referenced by <a class="el" href="neighbor_8c-source.html#l00090">get_mol_atm_neigh()</a>, and <a class="el" href="writepocket_8c-source.html#l00495">write_pocket_pdb()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00259"></a>00259 {
<a name="l00260"></a>00260         <span class="keywordtype">int</span> i ;
<a name="l00261"></a>00261         <span class="keywordflow">for</span>(i = 0 ; i &lt; nb_atm ; i++) {
<a name="l00262"></a>00262                 <span class="keywordflow">if</span>(atm_id == lst_atm[i]-&gt;<span class="keywordtype">id</span>) <span class="keywordflow">return</span> 1 ;
<a name="l00263"></a>00263         }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265         <span class="keywordflow">return</span> 0 ;
<a name="l00266"></a>00266 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9c0033f44cb65046ce5209b269da11d7"></a><!-- doxytag: member="atom.h::print_atoms" ref="9c0033f44cb65046ce5209b269da11d7" args="(FILE *f, s_atm *atoms, int natoms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_atoms           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> *&nbsp;</td>
          <td class="paramname"> <em>atoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>natoms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: void <a class="el" href="atom_8h.html#9c0033f44cb65046ce5209b269da11d7">print_atoms(FILE *f, s_atm *atoms, int natoms)</a><p>
## SPECIFICATION: Print list of atoms...<p>
## PARAMETRES: @ FILE *f : File to write in. @ <a class="el" href="structs__atm.html">s_atm</a> *atoms : List of atoms @ int natoms : Number of atoms<p>
## RETURN: 
<p>Definition at line <a class="el" href="atom_8c-source.html#l00330">330</a> of file <a class="el" href="atom_8c-source.html">atom.c</a>.</p>

<p>References <a class="el" href="atom_8h-source.html#l00070">s_atm::bfactor</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::chain</a>, <a class="el" href="atom_8h-source.html#l00063">s_atm::charge</a>, <a class="el" href="atom_8h-source.html#l00063">s_atm::id</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::mass</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::name</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::occupancy</a>, <a class="el" href="atom_8h-source.html#l00070">s_atm::radius</a>, <a class="el" href="atom_8h-source.html#l00063">s_atm::res_id</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::res_name</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::symbol</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::type</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00331"></a>00331 {
<a name="l00332"></a>00332         <a class="code" href="structs__atm.html">s_atm</a> *atom = NULL ;
<a name="l00333"></a>00333         <span class="keywordtype">int</span> i ;
<a name="l00334"></a>00334         <span class="keywordflow">for</span>(i = 0 ; i &lt; natoms ; i++) {
<a name="l00335"></a>00335                 atom = atoms + i ; 
<a name="l00336"></a>00336                 fprintf(f, <span class="stringliteral">"======== Atom %s (%d) ========\n"</span>, atom-&gt;<a class="code" href="structs__atm.html#2f0330a30f640668efdd726a6dd05a93">name</a>, atom-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>) ;
<a name="l00337"></a>00337                 fprintf(f, <span class="stringliteral">"Type: '%s', Residu: '%s' (%d), Chain: '%s'\n"</span>,
<a name="l00338"></a>00338                                         atom-&gt;<a class="code" href="structs__atm.html#98466fdfcb021884beb229b1dca361ae">type</a>, atom-&gt;<a class="code" href="structs__atm.html#e0ff20f2c491a8b16c866d9b1386b6a5">res_name</a>, atom-&gt;<a class="code" href="structs__atm.html#7c42c076ce151f4af210bef730b2b88f">res_id</a>, atom-&gt;<a class="code" href="structs__atm.html#c5b9464bd67f2cca101f7bf6beabb223">chain</a>);
<a name="l00339"></a>00339                 fprintf(f, <span class="stringliteral">"x: %f, y: %f, z: %f, occ: %f, bfact: %f\n"</span>, 
<a name="l00340"></a>00340                                         atom-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, atom-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, atom-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>, atom-&gt;<a class="code" href="structs__atm.html#1696926c680a1014360598d54a1dadb0">occupancy</a>, atom-&gt;<a class="code" href="structs__atm.html#6a1a5fd32629457dfa14626b25b5ae46">bfactor</a>);
<a name="l00341"></a>00341                 fprintf(f, <span class="stringliteral">"symbol: '%s', charge: %d, mass: %f, vdw: %f\n"</span>, 
<a name="l00342"></a>00342                                         atom-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>, atom-&gt;<a class="code" href="structs__atm.html#a03a199ed11108d7710547df629c7d73">charge</a>, atom-&gt;<a class="code" href="structs__atm.html#ebbe1b323a702c23ef5bb21888adb6a8">mass</a>, atom-&gt;<a class="code" href="structs__atm.html#28c2d3bc2d95eb928ea6b5d37184d7f4">radius</a>);
<a name="l00343"></a>00343         }
<a name="l00344"></a>00344 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6648ca5bb9d7384c43dda5156e333f24"></a><!-- doxytag: member="atom.h::set_mol_barycenter_ptr" ref="6648ca5bb9d7384c43dda5156e333f24" args="(s_atm **latoms, int natoms, float bary[3])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_mol_barycenter_ptr           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> **&nbsp;</td>
          <td class="paramname"> <em>latoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>natoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>bary</em>[3]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: set_mol_barycenter_ptr<p>
## SPECIFICATION: Calculate the barycenter of a molecule represented by a list of atoms pointers.<p>
## PARAMETRES: @ <a class="el" href="structs__atm.html">s_atm</a> **atoms : List of pointers to atoms structures @ int natoms : Number of atoms @ float bary[3] : OUTPUT: Where to store the calculated barycenter<p>
## RETURN: void (the OUTPUT is set using the input parameter bary) 
<p>Definition at line <a class="el" href="atom_8c-source.html#l00142">142</a> of file <a class="el" href="atom_8c-source.html">atom.c</a>.</p>

<p>References <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00143"></a>00143 {
<a name="l00144"></a>00144         <span class="keywordtype">float</span> xsum = 0.0, 
<a name="l00145"></a>00145                   ysum = 0.0,
<a name="l00146"></a>00146                   zsum = 0.0 ;
<a name="l00147"></a>00147         <span class="keywordtype">int</span> i ;
<a name="l00148"></a>00148         <span class="keywordflow">if</span>(latoms) {
<a name="l00149"></a>00149                 
<a name="l00150"></a>00150                 <span class="keywordflow">for</span>(i = 0 ; i &lt; natoms ; i++) {
<a name="l00151"></a>00151                         xsum += latoms[i]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a> ;
<a name="l00152"></a>00152                         ysum += latoms[i]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> ;
<a name="l00153"></a>00153                         zsum += latoms[i]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a> ;
<a name="l00154"></a>00154                 }
<a name="l00155"></a>00155         }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157         bary[0] = xsum / natoms ;
<a name="l00158"></a>00158         bary[1] = xsum / natoms ;
<a name="l00159"></a>00159         bary[2] = xsum / natoms ;
<a name="l00160"></a>00160 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 7 16:44:23 2010 for fpocket by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
